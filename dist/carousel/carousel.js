/*! License details at fancyapps.com/license */
import{isPlainObject as t}from"../utils/isPlainObject.js";import{isNode as e}from"../utils/isNode.js";import{isString as n}from"../utils/isString.js";import{getScrollableParent as i}from"../utils/getScrollableParent.js";import{getDirectChildren as o}from"../utils/getDirectChildren.js";import{extend as s}from"../utils/extend.js";import{map as r}from"../utils/map.js";import{stringToHtml as l}from"../utils/strToHtml.js";import{clamp as a}from"../utils/clamp.js";import{addClass as c}from"../utils/addClass.js";import{removeClass as d}from"../utils/removeClass.js";import{toggleClass as u}from"../utils/toggleClass.js";import{Tween as f}from"../libs/tween.js";import{Gestures as v,isTouchEvent as p}from"../libs/gestures.js";import{en_EN as g}from"./l10n/en_EN.js";const m=t=>{t.cancelable&&t.preventDefault()},h={adaptiveHeight:!1,center:!0,classes:{container:"f-carousel",isEnabled:"is-enabled",isLTR:"is-ltr",isRTL:"is-rtl",isHorizontal:"is-horizontal",isVertical:"is-vertical",hasAdaptiveHeight:"has-adaptive-height",viewport:"f-carousel__viewport",slide:"f-carousel__slide",isSelected:"is-selected"},dragFree:!1,enabled:!0,errorTpl:'<div class="f-html">{{ERROR}}</div>',fill:!1,infinite:!0,initialPage:0,l10n:g,rtl:!1,slides:[],slidesPerPage:"auto",spinnerTpl:'<div class="f-spinner"></div>',transition:"fade",tween:{clamp:!0,mass:1,tension:160,friction:25,restDelta:1,restSpeed:1,velocity:0},vertical:!1};let b,x=0;const E=(g,y={},w={})=>{x++;let M,S,j,P,L,A=0,O=Object.assign({},h),T=Object.assign({},h),R={},V=null,C=null,H=!1,D=!1,$=!1,z=!1,q="height",F=0,I=!0,k=0,B=0,N=0,_=0,G="*",X=[],Y=[];const W=new Set;let J=[],K=[],Q=0,U=0,Z=0;function tt(t,...e){let n=T[t];return n&&n instanceof Function?n(Dt,...e):n}function et(t,e=[]){const n=tt("l10n")||{};t=String(t).replace(/\{\{(\w+)\}\}/g,((t,e)=>n[e]||t));for(let n=0;n<e.length;n++)t=t.split(e[n][0]).join(e[n][1]);return t=t.replace(/\{\{(.*?)\}\}/g,((t,e)=>e))}const nt=new Map;function it(t,...e){const n=[...nt.get(t)||[]];T.on&&n.push(T.on[t]);for(const t of n)t&&t instanceof Function&&t(Dt,...e);"*"!==t&&it("*",t,...e)}function ot(){var e,n;const i=s({},h,O);s(i,h,O);let r="";const l=O.breakpoints||{};if(l)for(const[t,e]of Object.entries(l))window.matchMedia(t).matches&&(r+=t,s(i,e));if(void 0===L||r!==L){if(L=r,0!==A){let t=null===(n=null===(e=K[k])||void 0===e?void 0:e.slides[0])||void 0===n?void 0:n.index;void 0===t&&(t=T.initialSlide),i.initialSlide=t,i.slides=[];for(const t of X)t.isVirtual&&i.slides.push(t)}Vt(),T=i,!1!==T.enabled&&(A=0,it("init"),function(){for(const[t,e]of Object.entries(Object.assign(Object.assign({},w),T.plugins||{})))if(t&&!R[t]&&e instanceof Function){const n=e();n.init(Dt,E),R[t]=n}it("initPlugins")}(),function(){if(!V)return;const e=tt("classes")||{};c(V,e.container);const n=tt("style");if(n&&t(n))for(const[t,e]of Object.entries(n))V.style.setProperty(t,e);C=V.querySelector(`.${e.viewport}`),C||(C=document.createElement("div"),c(C,e.viewport),C.append(...o(V,`.${e.slide}`)),V.insertAdjacentElement("afterbegin",C)),V.carousel=Dt,it("initLayout")}(),function(){if(!C)return;const t=tt("classes")||{};X=[],[...o(C,`.${t.slide}`)].forEach((t=>{t.parentElement&&X.push(ht(Object.assign({el:t,isVirtual:!1},t.dataset||{})))})),mt(tt("slides"));for(const t of X)it("addSlide",t);for(const t of X){const e=t.el;(null==e?void 0:e.parentElement)&&(c(e,T.classes.slide),c(e,t.class),Ot(t),it("attachSlideEl",t))}it("initSlides")}(),wt(),function(){if(V&&(V.addEventListener("click",Pt,{passive:!1}),document.addEventListener("mousemove",st),!j)){let t=null;j=new ResizeObserver((e=>{t||(t=requestAnimationFrame((()=>{!function(t){var e;if(!V)return;if(0===A){const n=null===(e=t[0])||void 0===e?void 0:e.contentBoxSize[0],i=(null==n?void 0:n.blockSize)||0,o=(null==n?void 0:n.inlineSize)||0;return Q=i,U=o,A=1,c(V,(tt("classes")||{}).isEnabled),Rt(),S=f().on("start",(()=>{M&&M.isPointerDown()||(at(),Rt())})).on("step",(t=>{const e=F;F=t.pos,F!==e&&(I=!1,Rt())})).on("end",(t=>{(null==M?void 0:M.isPointerDown())||(F=t.pos,S&&!D&&(F<N||F>_)?S.spring({clamp:!0,mass:1,tension:200,friction:25,velocity:0,restDelta:1,restSpeed:1}).from({pos:F}).to({pos:a(N,F,_)}).start():I||(I=!0,it("settle")))})),rt(),ct(),void it("ready")}if(1!==A)return;const n=K.length;wt(),rt();const i=V.getBoundingClientRect(),o=i.height,s=i.width;n>1&&(z&&Math.abs(o-Q)<.5||!z&&Math.abs(s-U)<.5)||(Q=o,U=s,z&&!o||!z&&!s||V&&C&&(n===K.length&&(null==M?void 0:M.isPointerDown())||(tt("dragFree")&&(D||F>N&&F<_)?(at(),Rt()):Tt(k,{transition:!1}))))}(e),t=null})))})),j.observe(V)}}())}}function st(t){b=t}function rt(){if(!C)return;const t=tt("gestures");!1!==t?M||(M=v(C,t).on("start",(t=>{var e,n;if(!S)return;const{srcEvent:o}=t;z&&p(o)&&!i(o.target)&&m(o),S.pause(),S.getCurrentVelocities().pos=0;const s=null===(e=K[k])||void 0===e?void 0:e.slides[0];if(s&&W.has(s.index)&&s.el&&(F=s.offset||0,F+=(function(t){const e=window.getComputedStyle(t),n=new DOMMatrixReadOnly(e.transform);return{width:n.m41||0,height:n.m42||0}}(s.el)[q]||0)*($&&!z?1:-1)),St(),!D){(F<N||F>_)&&S.spring({clamp:!0,mass:1,tension:500,friction:25,velocity:(null===(n=S.getCurrentVelocities())||void 0===n?void 0:n.pos)||0,restDelta:1,restSpeed:1}).from({pos:F}).to({pos:a(N,F,_)}).start()}})).on("move",(t=>{var e,n;const{srcEvent:o,axis:s}=t,r=o.target;if(s||(o.stopPropagation(),o.stopImmediatePropagation()),("y"===s&&z||"x"===s&&!z)&&(m(o),o.stopPropagation()),!s)return;const{deltaX:l,deltaY:a}=t;if(!S)return;if(p(o)&&(null===(e=o.touches)||void 0===e?void 0:e.length)>1)return;if("y"===s&&!z||"x"===s&&z)return;if(r&&i(r)&&("x"!==s||z))return;const c=$&&!z?1:-1;let d=z?a:l,u=(null==S?void 0:S.isRunning())?S.getEndValues().pos:F,f=1;D||(u<=N&&d*c<0?(f=Math.max(.01,1-Math.abs(1/vt()*Math.abs(u-N))),f*=.2):u>=_&&d*c>0&&(f=Math.max(.01,1-Math.abs(1/vt()*Math.abs(u-_))),f*=.2)),u+=d*f*c,S.spring({clamp:!0,mass:1,tension:700,friction:25,velocity:(null===(n=S.getCurrentVelocities())||void 0===n?void 0:n.pos)||0,restDelta:1,restSpeed:1}).from({pos:F}).to({pos:u}).start()})).on("panstart",(t=>{(null==t?void 0:t.axis)===(z?"y":"x")&&c(C,"is-dragging")})).on("panend",(()=>{d(C,"is-dragging")})).on("end",(t=>{var e,n;const{srcEvent:o,axis:s,velocityX:r,velocityY:l,currentTouch:c}=t;if(c.length>0||!S)return;const d=o.target,u=d&&i(d)&&!("x"===s&&!z);z&&p(o)&&!t.axis&&Pt(o);const f=K.length,v=tt("dragFree");if(!f)return;const g=tt("vertical")?l:r;let m=(null==S?void 0:S.isRunning())?S.getEndValues().pos:F;const h=$&&!z?1:-1;if(u||(m+=g*(v?5:1)*h),!D&&(g*h<=0&&m<N||g*h>=0&&m>_)){let t=0;return Math.abs(g)>0&&(t=2*Math.abs(g),t=Math.min(.3*vt(),t)),m=a(N+-1*t,m,_+t),void S.spring({clamp:!0,mass:1,tension:380,friction:25,velocity:-1*g,restDelta:1,restSpeed:1}).from({pos:F}).to({pos:m}).start()}if(v||(null===(e=R.Autoscroll)||void 0===e?void 0:e.isEnabled()))return void(Math.abs(g)>10?S.spring({clamp:!0,mass:1,tension:150,friction:25,velocity:-1*g,restDelta:1,restSpeed:1}).from({pos:F}).to({pos:m}).start():S.isRunning()||I||(I=!0,it("settle")));if(!v&&!(null===(n=R.Autoscroll)||void 0===n?void 0:n.isEnabled())&&(!t.offsetX&&!t.offsetY||"y"===s&&!z||"x"===s&&z))return void Tt(k,{transition:"tween"});let b=ut(m);Math.abs(g)>10&&b===k&&(b+=g>0?$&&!z?1:-1:$&&!z?-1:1),Tt(b,{transition:"tween",tween:{velocity:-1*g}})})).init()):M&&(M.destroy(),M=void 0)}function lt(t="*"){var e;const n=[];for(const i of X)("*"===t||i.class&&i.class.includes(t)||i.el&&(null===(e=i.el)||void 0===e?void 0:e.classList.contains(t)))&&n.push(i);P=void 0,G=t,Y=[...n]}function at(){if(!S)return;const t=ut((null==S?void 0:S.isRunning())?S.getEndValues().pos:F);t!==k&&(P=k,k=t,Ot(),ct(),dt(),it("change",k,P))}function ct(){var t;if(!V)return;u(C,"is-draggable",!!M&&K.length>0);for(const t of V.querySelectorAll("[data-carousel-index]"))t.innerHTML=k+"";for(const t of V.querySelectorAll("[data-carousel-page]"))t.innerHTML=k+1+"";for(const t of V.querySelectorAll("[data-carousel-pages]"))t.innerHTML=K.length+"";for(const t of V.querySelectorAll("[data-carousel-go-prev]"))t.toggleAttribute("aria-disabled",!Ct()),Ct()?t.removeAttribute("tabindex"):t.setAttribute("tabindex","-1");for(const t of V.querySelectorAll("[data-carousel-go-next]"))t.toggleAttribute("aria-disabled",!Ht()),Ht()?t.removeAttribute("tabindex"):t.setAttribute("tabindex","-1");let e=!1;const n=null===(t=K[k])||void 0===t?void 0:t.slides[0];n&&(n.downloadSrc||"image"===n.type&&n.src)&&(e=!0);for(const t of V.querySelectorAll("[data-carousel-download]"))t.toggleAttribute("aria-disabled",!e)}function dt(t){var e;t||(t=null===(e=K[k])||void 0===e?void 0:e.slides[0]);const n=t.el;if(n)for(const e of n.querySelectorAll("[data-slide-index]"))e.innerHTML=t.index+1+""}function ut(t){var e,n,i;if(!K.length||!S)return 0;const o=pt();let s=t;D?s-=Math.floor((t-(null===(e=K[0])||void 0===e?void 0:e.pos))/o)*o:s=a(null===(n=K[0])||void 0===n?void 0:n.pos,t,null===(i=K[K.length-1])||void 0===i?void 0:i.pos);const r=new Map;let l=0;for(const t of K){const e=Math.abs(t.pos-s),n=Math.abs(t.pos-s-o),i=Math.abs(t.pos-s+o),a=Math.min(e,n,i);r.set(l,a),l++}const c=r.size>0?[...r.entries()].reduce(((t,e)=>e[1]<t[1]?e:t)):[k,0];return parseInt(c[0])}function ft(){return Z}function vt(){return C&&C.getBoundingClientRect()[q]||0}function pt(t=!0){return Y.reduce(((t,e)=>t+e.dim),0)+(Y.length-(D&&t?0:1))*Z}function gt(t){const e=pt();let n=vt();if(!C)return[];const i=[];if(!e||!n)return[];t=void 0===t?F:t,D&&(t-=Math.floor(t/e)*e);let o=0,s=0;if(H){const t=C.getBoundingClientRect();o=Math.abs(t.left),s=Math.abs(window.innerWidth-t.right)}let r=0;for(let l of Y){const a=(e=0)=>{i.indexOf(l)>-1||(l.pos=r-t+e||0,l.offset+e>t-l.dim-o+.51&&l.offset+e<t+n+s-.51&&i.push(l))};l.offset=r,D&&(a(e),a(-1*e)),a(),r+=l.dim+Z}return i}function mt(t,e){const n=[];for(const e of Array.isArray(t)?t:[t]){const t=ht(Object.assign(Object.assign({},e),{isVirtual:!0}));n.push(t)}X.splice(void 0===e?X.length:e,0,...n),yt();for(const t of n)bt(t);return lt(G),n}function ht(t){return(n(t)||t instanceof HTMLElement)&&(t={html:t}),Object.assign({index:-1,el:void 0,class:"",isVirtual:!0,dim:0,pos:0,offset:0,html:"",src:""},t)}function bt(t){if(!t)return;let e=t.el;e||(e=document.createElement("div"),t.el=e);const n=t.html?t.html instanceof HTMLElement?t.html:l(t.html):void 0;n&&(c(n,"f-html"),t.htmlEl=n,c(e,"has-html"),e.append(n),it("contentReady",t))}function xt(t){if(!C||!t)return;let e=t.el;if(e){if(e.setAttribute("index",t.index+""),e.parentElement!==C){let n;c(e,T.classes.slide),c(e,t.class),Ot(t);for(const e of X)if(e.index>t.index){n=e.el;break}C.insertBefore(e,n&&C.contains(n)?n:null),it("attachSlideEl",t)}return dt(t),e}}function Et(t){const e=null==t?void 0:t.el;e&&(e.remove(),Mt(e),it("detachSlideEl",t))}function yt(){for(let t=0;t<X.length;t++){const e=X[t],n=e.el;n&&(e.index!==t&&Mt(n),n.setAttribute("index",`${t}`)),e.index=t}}function wt(){var t,n,i,o,s;if(!V||!C)return;$=tt("rtl"),z=tt("vertical"),q=z?"height":"width";const r=tt("classes");u(V,r.isLTR,!$),u(V,r.isRTL,$),u(V,r.isHorizontal,!z),u(V,r.isVertical,z),u(V,r.hasAdaptiveHeight,tt("adaptiveHeight")),H="visible"===window.getComputedStyle(C).getPropertyValue("overflow-"+(z?"y":"x"));const l=C.getBoundingClientRect();if(!l.width&&!l.height)return;Z=C&&parseFloat(getComputedStyle(C).getPropertyValue("--f-carousel-gap"))||0;const d=function(){let t=0;if(C){let e=document.createElement("div");c(e,T.classes.slide),C.appendChild(e),t=e.getBoundingClientRect()[q],e.remove(),e=void 0}return t}();for(const n of Y){const i=n.el;let o=0;if(!n.isVirtual&&i&&e(i)){let e=!1;i.parentElement&&i.parentElement===C||(C.appendChild(i),e=!0),o=i.getBoundingClientRect()[q],e&&(null===(t=i.parentElement)||void 0===t||t.removeChild(i))}else o=d;n.dim=o}if(D=!1,tt("infinite")){D=!0;const t=pt();let e=vt();if(H){const t=C.getBoundingClientRect();e+=t.left,e+=t.right-t.width}for(let i=0;i<Y.length;i++){const o=(null===(n=Y[i])||void 0===n?void 0:n.dim)+Z;if(t-o<e&&t-o-e<o){D=!1;break}}}if(function(){var t;if(!V)return;yt();const e=vt(),n=pt(!1);let i=tt("slidesPerPage");i="auto"===i?1/0:parseFloat(i+""),K=[];let o=0,s=0;for(const n of Y)(!K.length||o+n.dim-e>.05||s>=i)&&(K.push({index:K.length,slides:[],dim:0,offset:0,pos:0}),o=0,s=0),null===(t=K[K.length-1])||void 0===t||t.slides.push(n),o+=n.dim+Z,s++;const r=tt("center"),l=tt("fill");let c=0;for(const t of K){t.dim=(t.slides.length-1)*Z;for(const e of t.slides)t.dim+=e.dim;t.offset=c,t.pos=c,!1!==r&&(t.pos-=.5*(e-t.dim)),l&&!D&&n>e&&(t.pos=a(0,t.pos,n-e)),c+=t.dim+Z}const d=[];let u;for(const t of K){const e=Object.assign({},t);u&&Math.abs(e.pos-u.pos)<.1?(u.dim+=e.dim,u.slides=[...u.slides,...e.slides]):(u=e,e.index=d.length,d.push(e))}K=d,ct()}(),N=(null===(i=K[0])||void 0===i?void 0:i.pos)||0,_=(null===(o=K[K.length-1])||void 0===o?void 0:o.pos)||0,0===A)!function(){var t;P=void 0,k=tt("initialPage");const e=tt("initialSlide")||void 0;void 0!==e&&(k=Dt.getPageIndex(e)||0),k=a(0,k,K.length-1),F=(null===(t=K[k])||void 0===t?void 0:t.pos)||0,B=F}();else{const t=(null==S?void 0:S.isRunning())?S.getEndValues().pos:F;(t<N||t>_)&&(k=a(0,k,K.length-1),B=(null===(s=K[k||0])||void 0===s?void 0:s.pos)||0)}it("refresh")}function Mt(t){if(!t||!e(t))return;const n=parseInt(t.getAttribute("index")||"-1");let i="";for(const e of Array.from(t.classList)){const t=e.match(/^f-(\w+)(Out|In)$/);t&&t[1]&&(i=t[1]+"")}if(!t||!i)return;const o=[`f-${i}Out`,`f-${i}In`,"to-prev","to-next","from-prev","from-next"];t.removeEventListener("animationend",jt),d(t,o.join(" ")),W.delete(n)}function St(){if(!C)return;const t=W.size;for(const t of Y)Mt(t.el);W.clear(),t&&Rt()}function jt(t){"f-"===t.animationName.substring(0,2)&&(Mt(t.target),W.size||(d(V,"in-transition"),!I&&Math.abs(Dt.getPosition(!0)-B)<.5&&(I=!0,it("settle"))),Rt())}function Pt(t){var e;if(t.defaultPrevented)return;const n=t.composedPath()[0];if(n.closest("[data-carousel-go-prev]"))return m(t),void Dt.prev();if(n.closest("[data-carousel-go-next]"))return m(t),void Dt.next();const i=n.closest("[data-carousel-go-to]");if(i)return m(t),void Dt.goTo(parseFloat(i.dataset.carouselGoTo||"")||0);if(n.closest("[data-carousel-download]")){m(t);const n=null===(e=K[k])||void 0===e?void 0:e.slides[0];if(n&&(n.downloadSrc||"image"===n.type&&n.src)){const t=n.downloadFilename,e=document.createElement("a"),i=n.downloadSrc||n.src||"";e.href=i,e.target="_blank",e.download=t||i,e.click()}}else it("click",t)}function Lt(t){var e;const n=t.el;n&&(null===(e=n.querySelector(".f-spinner"))||void 0===e||e.remove())}function At(t){var e;const n=t.el;n&&(null===(e=n.querySelector(".f-html.is-error"))||void 0===e||e.remove(),d(n,"has-error"))}function Ot(t){var e;t||(t=null===(e=K[k])||void 0===e?void 0:e.slides[0]);const i=null==t?void 0:t.el;if(!i)return;let o=tt("formatCaption",t);void 0===o&&(o=t.caption),o=o||"";const s=tt("captionEl");if(s&&s instanceof HTMLElement){if(t.index!==k)return;if(n(o)&&(s.innerHTML=et(o+"")),o instanceof HTMLElement){if(o.parentElement===s)return;s.innerHTML="",o.parentElement&&(o=o.cloneNode(!0)),s.append(o)}return}if(!o)return;let r=t.captionEl||i.querySelector(".f-caption");!r&&o instanceof HTMLElement&&o.classList.contains("f-caption")&&(r=o),r||(r=document.createElement("div"),c(r,"f-caption"),n(o)?r.innerHTML=et(o+""):o instanceof HTMLElement&&(o.parentElement&&(o=o.cloneNode(!0)),r.append(o)));const l=`f-caption-${x}_${t.index}`;r.setAttribute("id",l),r.dataset.selectable="true",c(i,"has-caption"),i.setAttribute("aria-labelledby",l),t.captionEl=r,i.insertAdjacentElement("beforeend",r)}function Tt(e,i={}){var o,r;let{transition:l,tween:u}=Object.assign({transition:T.transition,tween:T.tween},i||{});if(!V||!S)return;const f=K.length;if(!f)return;if(function(t,e){var i,o,s,r;if(!(V&&S&&e&&n(e)&&"tween"!==e))return!1;if((null===(i=K[k])||void 0===i?void 0:i.slides.length)>1)return!1;const l=K.length;let u=t>k?1:-1;t=D?(t%l+l)%l:a(0,t,l-1),$&&(u*=-1);const f=null===(o=K[k])||void 0===o?void 0:o.slides[0],v=null==f?void 0:f.index,p=null===(s=K[t])||void 0===s?void 0:s.slides[0],g=null==p?void 0:p.index,m=null===(r=K[t])||void 0===r?void 0:r.pos;if(void 0===g||void 0===v||v===g||F===m||Math.abs(vt()-((null==p?void 0:p.dim)||0))>1)return!1;I=!1,S.pause(),St(),c(V,"in-transition"),F=B=m;const h=xt(f),b=xt(p);return at(),h&&(W.add(v),h.style.transform="",h.addEventListener("animationend",jt),d(h,T.classes.isSelected),h.inert=!1,c(h,`f-${e}Out to-${u>0?"next":"prev"}`)),b&&(W.add(g),b.style.transform="",b.addEventListener("animationend",jt),c(b,T.classes.isSelected),b.inert=!1,c(b,`f-${e}In from-${u>0?"prev":"next"}`)),Rt(),!0}(e,l))return;e=D?(e%f+f)%f:a(0,e,f-1),B=(null===(o=K[e||0])||void 0===o?void 0:o.pos)||0;const v=S.isRunning()?S.getEndValues().pos:F;if(Math.abs(B-v)<1)return F=B,k!==e&&(Ot(),ct(),dt(),P=k,k=e,it("change",k,P)),Rt(),void(I||(I=!0,it("settle")));if(S.pause(),St(),D){const t=pt(),e=Math.floor((v-(null===(r=K[0])||void 0===r?void 0:r.pos))/t),n=B+e*t;B=[n+t,n,n-t].reduce((function(t,e){return Math.abs(e-v)<Math.abs(t-v)?e:t}))}!1!==l&&t(u)?S.spring(s({},T.tween,u)).from({pos:F}).to({pos:B}).start():(F=B,at(),Rt(),I||(I=!0,it("settle")))}function Rt(){var t;if(!V||!C)return;const e=K[k];J=gt();const n=new Set;let i;const s=[];for(const o of Y){if(o.isVirtual&&!W.has(o.index)&&J.indexOf(o)<0)continue;let r=xt(o);if(!r)continue;s.push(o);const l=(null===(t=null==e?void 0:e.slides)||void 0===t?void 0:t.indexOf(o))>-1;if(l&&n.add(r),tt("adaptiveHeight")&&l){const t=(r.firstElementChild||r).getBoundingClientRect().height;i=null==i?t:Math.max(i,t)}}C&&i&&(C.style.height=`${i}px`),[...o(C,`.${T.classes.slide}`)].forEach((t=>{const e=parseInt(t.getAttribute("index")||"-1"),i=X[e];i||t.remove();const o=n.has(t);if(u(t,T.classes.isSelected,o),t.inert=J.indexOf(i)<0,i.isVirtual&&!W.has(i.index)&&J.indexOf(i)<0)return void Et(i);let s=i.pos?Math.round(1e4*i.pos)/1e4:0,l=0,a=0,c=0,d=0,f=T.setTransform||void 0;W.has(i.index)||(l=z?0:$?-1*s:s,a=z?s:0,c=r(l,0,i.dim,0,100),d=r(a,0,i.dim,0,100)),f instanceof Function&&!W.has(i.index)?f(Dt,i,{x:l,y:a,xPercent:c,yPercent:d}):t.style.transform=l||a?`translate3d(${c}%, ${d}%,0)`:""})),it("render",s)}function Vt(){var t;null==V||V.removeEventListener("click",Pt),St(),document.removeEventListener("mousemove",st),null==j||j.disconnect(),j=void 0;for(const n of X)n.el&&e(n.el)&&(n.state=void 0,Lt(n),At(n),Et(n),n.isVirtual?(null===(t=n.el)||void 0===t||t.remove(),n.el=void 0):(n.el.style.transform="",null==C||C.appendChild(n.el)));for(const t of Object.values(R))null==t||t.destroy();R={},null==M||M.destroy(),M=void 0,null==S||S.destroy(),S=void 0;for(const[t,e]of Object.entries(T.classes||{}))"container"!==t&&d(V,e);d(C,"is-draggable")}function Ct(){return D||k>0}function Ht(){return D||k<K.length-1}const Dt={add:function(t,e){var n,i;let o=F;const s=k,r=pt(),l=(null==S?void 0:S.isRunning())?S.getEndValues().pos:F,a=Math.floor((l-(null===(n=K[0])||void 0===n?void 0:n.pos))/r),c=mt(t,e);for(const t of c)it("addSlide",t);return lt(G),wt(),S&&(s===k&&(o-=a*r),B=(null===(i=K[k||0])||void 0===i?void 0:i.pos)||0,o===B?F=B:S.spring({clamp:!0,mass:1,tension:300,friction:25,restDelta:1,restSpeed:1}).from({pos:o}).to({pos:B}).start()),Rt(),Dt},canGoPrev:Ct,canGoNext:Ht,destroy:function(){return it("destroy"),window.removeEventListener("resize",ot),Vt(),nt.clear(),V=null,K=[],X=[],T=Object.assign({},h),R={},Y=[],L="",G="*",A=2,Dt},emit:it,filter:function(t="*"){return lt(t),wt(),Rt(),it("filter",t),Dt},getContainer:function(){return V},getGapDim:ft,getGestures:function(){return M},getLastMouseMove:function(){return b},getOption:function(t){return tt(t)},getOptions:function(){return T},getPage:function(){return K[k]},getPageIndex:function(t){if(void 0!==t){for(const e of K||[])for(const n of e.slides)if(n.index===t)return e.index;return-1}return k},getPageProgress:function(t,e){var n;void 0===t&&(t=k);const i=K[t];if(!i)return t>k?-1:1;const o=pt(),s=ft();let r=i.pos,l=Dt.getPosition();if(D&&!0!==e){const t=Math.floor((l-(null===(n=K[0])||void 0===n?void 0:n.pos))/o);l-=t*o,r=[r+o,r,r-o].reduce((function(t,e){return Math.abs(e-l)<Math.abs(t-l)?e:t}))}return(l-r)/(i.dim+s)},getPageVisibility:function(t){var e;void 0===t&&(t=k);const n=K[t];if(!n)return t>k?-1:1;const i=Dt.getPosition(),o=vt();let s=n.pos;if(D){const t=Dt.getPosition(),n=pt(),i=s+Math.floor((t-(null===(e=K[0])||void 0===e?void 0:e.pos))/n)*n;s=[i+n,i,i-n].reduce((function(e,n){return Math.abs(n-t)<Math.abs(e-t)?n:e}))}return s>i&&s+n.dim<i+o?1:s<i?(s+n.dim-i)/n.dim:s+n.dim>i+o?(i+o-s)/n.dim:0},getPages:function(){return K},getPlugins:function(){return R},getPosition:function(t){var e;let n=F;if(D&&!0!==t){const t=pt();n-=Math.floor((F-(null===(e=K[0])||void 0===e?void 0:e.pos)||0)/t)*t}return n},getSlides:function(){return X},getState:function(){return A},getTotalSlideDim:pt,getTween:function(){return S},getViewport:function(){return C},getViewportDim:vt,getVisibleSlides:function(t){return void 0===t?J:gt(t)},goTo:Tt,hasNavigated:function(){return void 0!==P},hideError:At,hideLoading:Lt,init:function(){if(!g||!e(g))throw new Error("No Element found");return 0!==A&&(Vt(),A=0),V=g,O=y,window.removeEventListener("resize",ot),O.breakpoints&&window.addEventListener("resize",ot),ot(),Dt},isInfinite:function(){return D},isInTransition:function(){return W.size>0},isRTL:function(){return $},isSettled:function(){return I},isVertical:function(){return z},localize:function(t,e=[]){return et(t,e)},next:function(t={}){return Tt(k+1,t),Dt},off:function(t,e){for(const n of t instanceof Array?t:[t])nt.has(n)&&nt.set(n,nt.get(n).filter((t=>t!==e)));return Dt},on:function(t,e){for(const n of t instanceof Array?t:[t])nt.set(n,[...nt.get(n)||[],e]);return Dt},prev:function(t={}){return Tt(k-1,t),Dt},remove:function(t){void 0===t&&(t=X.length-1);const e=X[t];return e&&(it("removeSlide",e),e.el&&(Mt(e.el),e.el.remove(),e.el=void 0),X.splice(t,1),lt(G),wt(),Rt()),Dt},setPosition:function(t){F=t,at(),Rt()},showError:function(t,e){Lt(t),At(t);const n=t.el;if(n){const i=document.createElement("div");c(i,"f-html"),c(i,"is-error"),i.innerHTML=et(e||"<p>{{ERROR}}</p>"),t.htmlEl=i,c(n,"has-html"),c(n,"has-error"),n.insertAdjacentElement("afterbegin",i),it("contentReady",t)}return Dt},showLoading:function(t){const e=t.el,n=null==e?void 0:e.querySelector(".f-spinner");if(!e||n)return Dt;const i=tt("spinnerTpl"),o=l(i);return o&&(c(o,"f-spinner"),e.insertAdjacentElement("beforeend",o)),Dt},version:"6.0.33"};return Dt};E.l10n={en_EN:g},E.getDefaults=()=>h;export{E as Carousel};
