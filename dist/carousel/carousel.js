/*! License details at fancyapps.com/license */
import{isPlainObject as e}from"../utils/isPlainObject.js";import{isNode as t}from"../utils/isNode.js";import{isString as n}from"../utils/isString.js";import{getScrollableParent as i}from"../utils/getScrollableParent.js";import{getDirectChildren as o}from"../utils/getDirectChildren.js";import{extend as s}from"../utils/extend.js";import{map as r}from"../utils/map.js";import{stringToHtml as l}from"../utils/strToHtml.js";import{clamp as a}from"../utils/clamp.js";import{addClass as c}from"../utils/addClass.js";import{removeClass as d}from"../utils/removeClass.js";import{toggleClass as u}from"../utils/toggleClass.js";import{Tween as f}from"../libs/tween.js";import{Gestures as v,isTouchEvent as p}from"../libs/gestures.js";import{en_EN as g}from"./l10n/en_EN.js";const m=e=>{e.cancelable&&e.preventDefault()},h={adaptiveHeight:!1,center:!0,classes:{container:"f-carousel",isEnabled:"is-enabled",isLTR:"is-ltr",isRTL:"is-rtl",isHorizontal:"is-horizontal",isVertical:"is-vertical",hasAdaptiveHeight:"has-adaptive-height",viewport:"f-carousel__viewport",slide:"f-carousel__slide",isSelected:"is-selected"},dragFree:!1,enabled:!0,errorTpl:'<div class="f-html">{{ERROR}}</div>',fill:!1,infinite:!0,initialPage:0,l10n:g,rtl:!1,slides:[],slidesPerPage:"auto",spinnerTpl:'<div class="f-spinner"></div>',transition:"fade",tween:{clamp:!0,mass:1,tension:160,friction:25,restDelta:1,restSpeed:1,velocity:0},vertical:!1};let b,E=0;const y=(g,x={},M={})=>{E++;let w,S,j,P,L,A=0,O=Object.assign({},h),T=Object.assign({},h),R={},V=null,C=null,H=!1,D=!1,$=!1,z=!1,q="height",k=0,F=!0,I=0,B=0,N=0,_=0,G="*",X=[],Y=[];const W=new Set;let J=[],K=[],Q=0,U=0,Z=0;function ee(e,...t){let n=T[e];return n&&n instanceof Function?n(De,...t):n}function te(e,t=[]){const n=ee("l10n")||{};e=String(e).replace(/\{\{(\w+)\}\}/g,((e,t)=>n[t]||e));for(let n=0;n<t.length;n++)e=e.split(t[n][0]).join(t[n][1]);return e=e.replace(/\{\{(.*?)\}\}/g,((e,t)=>t))}const ne=new Map;function ie(e,...t){const n=[...ne.get(e)||[]];T.on&&n.push(T.on[e]);for(const e of n)e&&e instanceof Function&&e(De,...t);"*"!==e&&ie("*",e,...t)}function oe(){var t,n;const i=s({},h,O);s(i,h,O);let r="";const l=O.breakpoints||{};if(l)for(const[e,t]of Object.entries(l))window.matchMedia(e).matches&&(r+=e,s(i,t));if(void 0===L||r!==L){if(L=r,0!==A){let e=null===(n=null===(t=K[I])||void 0===t?void 0:t.slides[0])||void 0===n?void 0:n.index;void 0===e&&(e=T.initialSlide),i.initialSlide=e,i.slides=[];for(const e of X)e.isVirtual&&i.slides.push(e)}Ve(),T=i,!1!==T.enabled&&(A=0,ie("init"),function(){for(const[e,t]of Object.entries(Object.assign(Object.assign({},M),T.plugins||{})))if(e&&!R[e]&&t instanceof Function){const n=t();n.init(De,y),R[e]=n}ie("initPlugins")}(),function(){if(!V)return;const t=ee("classes")||{};c(V,t.container);const n=ee("style");if(n&&e(n))for(const[e,t]of Object.entries(n))V.style.setProperty(e,t);C=V.querySelector(`.${t.viewport}`),C||(C=document.createElement("div"),c(C,t.viewport),C.append(...o(V,`.${t.slide}`)),V.insertAdjacentElement("afterbegin",C)),V.carousel=De,ie("initLayout")}(),function(){if(!C)return;const e=ee("classes")||{};X=[],[...o(C,`.${e.slide}`)].forEach((e=>{if(e.parentElement){const t=he(Object.assign({el:e,isVirtual:!1},e.dataset||{}));ie("createSlide",t),X.push(t)}})),xe();for(const e of X)ie("addSlide",e);me(ee("slides"));for(const e of X){const t=e.el;(null==t?void 0:t.parentElement)===C&&(c(t,T.classes.slide),c(t,e.class),Oe(e),ie("attachSlideEl",e))}ie("initSlides")}(),Me(),function(){if(V&&C&&(V.addEventListener("click",Pe,{passive:!1}),document.addEventListener("mousemove",se),!j)){let e=null;j=new ResizeObserver((t=>{e||(e=requestAnimationFrame((()=>{!function(e){var t;if(!C)return;if(0===A){const n=null===(t=e[0])||void 0===t?void 0:t.contentBoxSize[0],i=(null==n?void 0:n.blockSize)||0,o=(null==n?void 0:n.inlineSize)||0;return Q=i,U=o,A=1,c(V,(ee("classes")||{}).isEnabled),Re(),S=f().on("start",(()=>{w&&w.isPointerDown()||(ae(),Re())})).on("step",(e=>{const t=k;k=e.pos,k!==t&&(F=!1,Re())})).on("end",(e=>{(null==w?void 0:w.isPointerDown())||(k=e.pos,S&&!D&&(k<N||k>_)?S.spring({clamp:!0,mass:1,tension:200,friction:25,velocity:0,restDelta:1,restSpeed:1}).from({pos:k}).to({pos:a(N,k,_)}).start():F||(F=!0,ie("settle")))})),re(),ce(),void ie("ready")}if(1!==A)return;const n=K.length;Me(),re();const i=C.getBoundingClientRect(),o=i.height,s=i.width;n>1&&(z&&Math.abs(o-Q)<.5||!z&&Math.abs(s-U)<.5)||(Q=o,U=s,z&&!o||!z&&!s||V&&C&&(n===K.length&&(null==w?void 0:w.isPointerDown())||(ee("dragFree")&&(D||k>N&&k<_)?(ae(),Re()):Te(I,{transition:!1}))))}(t),e=null})))})),j.observe(C)}}())}}function se(e){b=e}function re(){if(!C)return;const e=ee("gestures");!1!==e?w||(w=v(C,e).on("start",(e=>{var t,n;if(!S)return;const{srcEvent:o}=e;z&&p(o)&&!i(o.target)&&m(o),S.pause(),S.getCurrentVelocities().pos=0;const s=null===(t=K[I])||void 0===t?void 0:t.slides[0];if(s&&W.has(s.index)&&s.el&&(k=s.offset||0,k+=(function(e){const t=window.getComputedStyle(e),n=new DOMMatrixReadOnly(t.transform);return{width:n.m41||0,height:n.m42||0}}(s.el)[q]||0)*($&&!z?1:-1)),Se(),!D){(k<N||k>_)&&S.spring({clamp:!0,mass:1,tension:500,friction:25,velocity:(null===(n=S.getCurrentVelocities())||void 0===n?void 0:n.pos)||0,restDelta:1,restSpeed:1}).from({pos:k}).to({pos:a(N,k,_)}).start()}})).on("move",(e=>{var t,n;const{srcEvent:o,axis:s}=e,r=o.target;if(s||(m(o),o.stopPropagation(),o.stopImmediatePropagation()),("y"===s&&z||"x"===s&&!z)&&(m(o),o.stopPropagation()),!s)return;const{deltaX:l,deltaY:a}=e;if(!S)return;if(p(o)&&(null===(t=o.touches)||void 0===t?void 0:t.length)>1)return;if("y"===s&&!z||"x"===s&&z)return;if(r&&i(r)&&("x"!==s||z))return;const c=$&&!z?1:-1;let d=z?a:l,u=(null==S?void 0:S.isRunning())?S.getEndValues().pos:k,f=1;D||(u<=N&&d*c<0?(f=Math.max(.01,1-Math.abs(1/ve()*Math.abs(u-N))),f*=.2):u>=_&&d*c>0&&(f=Math.max(.01,1-Math.abs(1/ve()*Math.abs(u-_))),f*=.2)),u+=d*f*c,S.spring({clamp:!0,mass:1,tension:700,friction:25,velocity:(null===(n=S.getCurrentVelocities())||void 0===n?void 0:n.pos)||0,restDelta:1,restSpeed:1}).from({pos:k}).to({pos:u}).start()})).on("panstart",(e=>{(null==e?void 0:e.axis)===(z?"y":"x")&&c(C,"is-dragging")})).on("panend",(()=>{d(C,"is-dragging")})).on("end",(e=>{var t,n;const{srcEvent:o,axis:s,velocityX:r,velocityY:l,currentTouch:c}=e;if(c.length>0||!S)return;const d=o.target,u=d&&i(d)&&!("x"===s&&!z);z&&p(o)&&!e.axis&&Pe(o);const f=K.length,v=ee("dragFree");if(!f)return;const g=ee("vertical")?l:r;let m=(null==S?void 0:S.isRunning())?S.getEndValues().pos:k;const h=$&&!z?1:-1;if(u||(m+=g*(v?5:1)*h),!D&&(g*h<=0&&m<N||g*h>=0&&m>_)){let e=0;return Math.abs(g)>0&&(e=2*Math.abs(g),e=Math.min(.3*ve(),e)),m=a(N+-1*e,m,_+e),void S.spring({clamp:!0,mass:1,tension:380,friction:25,velocity:-1*g,restDelta:1,restSpeed:1}).from({pos:k}).to({pos:m}).start()}if(v||(null===(t=R.Autoscroll)||void 0===t?void 0:t.isEnabled()))return void(Math.abs(g)>10?S.spring({clamp:!0,mass:1,tension:150,friction:25,velocity:-1*g,restDelta:1,restSpeed:1}).from({pos:k}).to({pos:m}).start():S.isRunning()||F||(F=!0,ie("settle")));if(!v&&!(null===(n=R.Autoscroll)||void 0===n?void 0:n.isEnabled())&&(!e.offsetX&&!e.offsetY||"y"===s&&!z||"x"===s&&z))return void Te(I,{transition:"tween"});let b=ue(m);Math.abs(g)>10&&b===I&&(b+=g>0?$&&!z?1:-1:$&&!z?-1:1),Te(b,{transition:"tween",tween:{velocity:-1*g}})})).init()):w&&(w.destroy(),w=void 0)}function le(e="*"){var t;const n=[];for(const i of X)("*"===e||i.class&&i.class.includes(e)||i.el&&(null===(t=i.el)||void 0===t?void 0:t.classList.contains(e)))&&n.push(i);P=void 0,G=e,Y=[...n]}function ae(){if(!S)return;const e=ue((null==S?void 0:S.isRunning())?S.getEndValues().pos:k);e!==I&&(P=I,I=e,Oe(),ce(),de(),ie("change",I,P))}function ce(){var e;if(!V)return;u(C,"is-draggable",!!w&&K.length>0);for(const e of V.querySelectorAll("[data-carousel-index]"))e.innerHTML=I+"";for(const e of V.querySelectorAll("[data-carousel-page]"))e.innerHTML=I+1+"";for(const e of V.querySelectorAll("[data-carousel-pages]"))e.innerHTML=K.length+"";for(const e of V.querySelectorAll("[data-carousel-go-prev]"))e.toggleAttribute("aria-disabled",!Ce()),Ce()?e.removeAttribute("tabindex"):e.setAttribute("tabindex","-1");for(const e of V.querySelectorAll("[data-carousel-go-next]"))e.toggleAttribute("aria-disabled",!He()),He()?e.removeAttribute("tabindex"):e.setAttribute("tabindex","-1");let t=!1;const n=null===(e=K[I])||void 0===e?void 0:e.slides[0];n&&(n.downloadSrc||"image"===n.type&&n.src)&&(t=!0);for(const e of V.querySelectorAll("[data-carousel-download]"))e.toggleAttribute("aria-disabled",!t)}function de(e){var t;e||(e=null===(t=K[I])||void 0===t?void 0:t.slides[0]);const n=e.el;if(n)for(const t of n.querySelectorAll("[data-slide-index]"))t.innerHTML=e.index+1+""}function ue(e){var t,n,i;if(!K.length||!S)return 0;const o=pe();let s=e;D?s-=Math.floor((e-(null===(t=K[0])||void 0===t?void 0:t.pos))/o)*o:s=a(null===(n=K[0])||void 0===n?void 0:n.pos,e,null===(i=K[K.length-1])||void 0===i?void 0:i.pos);const r=new Map;let l=0;for(const e of K){const t=Math.abs(e.pos-s),n=Math.abs(e.pos-s-o),i=Math.abs(e.pos-s+o),a=Math.min(t,n,i);r.set(l,a),l++}const c=r.size>0?[...r.entries()].reduce(((e,t)=>t[1]<e[1]?t:e)):[I,0];return parseInt(c[0])}function fe(){return Z}function ve(){let e=0;return C&&(C.childElementCount||(C.style.display="block"),e=C.getBoundingClientRect()[q]||0,C.style.display=""),e}function pe(e=!0){return Y.reduce(((e,t)=>e+t.dim),0)+(Y.length-(D&&e?0:1))*Z}function ge(e){const t=pe();let n=ve();if(!C)return[];const i=[];if(!t||!n)return[];e=void 0===e?k:e,D&&(e-=Math.floor(e/t)*t);let o=0,s=0;if(H){const e=C.getBoundingClientRect();o=Math.abs(e.left),s=Math.abs(window.innerWidth-e.right)}let r=0;for(let l of Y){const a=(t=0)=>{i.indexOf(l)>-1||(l.pos=r-e+t||0,l.offset+t>e-l.dim-o+.51&&l.offset+t<e+n+s-.51&&i.push(l))};l.offset=r,D&&(a(t),a(-1*t)),a(),r+=l.dim+Z}return i}function me(e,t){const n=[];for(const t of Array.isArray(e)?e:[e]){const e=he(Object.assign(Object.assign({},t),{isVirtual:!0}));e.el||(e.el=document.createElement("div")),ie("createSlide",e),n.push(e)}X.splice(void 0===t?X.length:t,0,...n),xe();for(const e of n)ie("addSlide",e),be(e);return le(G),n}function he(e){return(n(e)||e instanceof HTMLElement)&&(e={html:e}),Object.assign({index:-1,el:void 0,class:"",isVirtual:!0,dim:0,pos:0,offset:0,html:"",src:""},e)}function be(e){let t=e.el;if(!e||!t)return;const n=e.html?e.html instanceof HTMLElement?e.html:l(e.html):void 0;n&&(c(n,"f-html"),e.htmlEl=n,c(t,"has-html"),t.append(n),ie("contentReady",e))}function Ee(e){if(!C||!e)return;let t=e.el;if(t){if(t.setAttribute("index",e.index+""),t.parentElement!==C){let n;c(t,T.classes.slide),c(t,e.class),Oe(e);for(const t of X)if(t.index>e.index){n=t.el;break}C.insertBefore(t,n&&C.contains(n)?n:null),ie("attachSlideEl",e)}return de(e),t}}function ye(e){const t=null==e?void 0:e.el;t&&(t.remove(),we(t),ie("detachSlideEl",e))}function xe(){for(let e=0;e<X.length;e++){const t=X[e],n=t.el;n&&(t.index!==e&&we(n),n.setAttribute("index",`${e}`)),t.index=e}}function Me(){var e,n,i,o,s;if(!V||!C)return;$=ee("rtl"),z=ee("vertical"),q=z?"height":"width";const r=ee("classes");if(u(V,r.isLTR,!$),u(V,r.isRTL,$),u(V,r.isHorizontal,!z),u(V,r.isVertical,z),u(V,r.hasAdaptiveHeight,ee("adaptiveHeight")),!ve())return;const l=window.getComputedStyle(C);H="visible"===l.getPropertyValue("overflow-"+(z?"y":"x")),Z=C&&parseFloat(l.getPropertyValue("--f-carousel-gap"))||0;const d=function(){let e=0;if(C){let t=document.createElement("div");t.style.display="block",c(t,T.classes.slide),C.appendChild(t),e=t.getBoundingClientRect()[q],t.remove(),t=void 0}return e}();for(const n of Y){const i=n.el;let o=0;if(!n.isVirtual&&i&&t(i)){let t=!1;i.parentElement&&i.parentElement===C||(C.appendChild(i),t=!0),o=i.getBoundingClientRect()[q],t&&(null===(e=i.parentElement)||void 0===e||e.removeChild(i))}else o=d;n.dim=o}if(D=!1,ee("infinite")){D=!0;const e=pe();let t=ve();if(H){const e=C.getBoundingClientRect();t+=e.left,t+=e.right-e.width}for(let i=0;i<Y.length;i++){const o=(null===(n=Y[i])||void 0===n?void 0:n.dim)+Z;if(e-o<t&&e-o-t<o){D=!1;break}}}if(function(){var e;if(!V)return;const t=ve(),n=pe(!1);let i=ee("slidesPerPage");i="auto"===i?1/0:parseFloat(i+""),K=[];let o=0,s=0;for(const n of Y)(!K.length||o+n.dim-t>.05||s>=i)&&(K.push({index:K.length,slides:[],dim:0,offset:0,pos:0}),o=0,s=0),null===(e=K[K.length-1])||void 0===e||e.slides.push(n),o+=n.dim+Z,s++;const r=ee("center"),l=ee("fill");let c=0;for(const e of K){e.dim=(e.slides.length-1)*Z;for(const t of e.slides)e.dim+=t.dim;e.offset=c,e.pos=c,!1!==r&&(e.pos-=.5*(t-e.dim)),l&&!D&&n>t&&(e.pos=a(0,e.pos,n-t)),c+=e.dim+Z}const d=[];let u;for(const e of K){const t=Object.assign({},e);u&&Math.abs(t.pos-u.pos)<.1?(u.dim+=t.dim,u.slides=[...u.slides,...t.slides]):(u=t,t.index=d.length,d.push(t))}K=d,ce()}(),N=(null===(i=K[0])||void 0===i?void 0:i.pos)||0,_=(null===(o=K[K.length-1])||void 0===o?void 0:o.pos)||0,0===A)!function(){var e;P=void 0,I=ee("initialPage");const t=ee("initialSlide")||void 0;void 0!==t&&(I=De.getPageIndex(t)||0),I=a(0,I,K.length-1),k=(null===(e=K[I])||void 0===e?void 0:e.pos)||0,B=k}();else{const e=(null==S?void 0:S.isRunning())?S.getEndValues().pos:k;(e<N||e>_)&&(I=a(0,I,K.length-1),B=(null===(s=K[I||0])||void 0===s?void 0:s.pos)||0)}ie("refresh")}function we(e){if(!e||!t(e))return;const n=parseInt(e.getAttribute("index")||"-1");let i="";for(const t of Array.from(e.classList)){const e=t.match(/^f-(\w+)(Out|In)$/);e&&e[1]&&(i=e[1]+"")}if(!e||!i)return;const o=[`f-${i}Out`,`f-${i}In`,"to-prev","to-next","from-prev","from-next"];e.removeEventListener("animationend",je),d(e,o.join(" ")),W.delete(n)}function Se(){if(!C)return;const e=W.size>0;for(const e of Y)we(e.el);W.clear(),e&&Re()}function je(e){"f-"===e.animationName.substring(0,2)&&(we(e.target),W.size||(d(V,"in-transition"),!F&&Math.abs(De.getPosition(!0)-B)<.5&&(F=!0,ie("settle"))),Re())}function Pe(e){var t;if(e.defaultPrevented)return;const n=e.composedPath()[0];if(n.closest("[data-carousel-go-prev]"))return m(e),void De.prev();if(n.closest("[data-carousel-go-next]"))return m(e),void De.next();const i=n.closest("[data-carousel-go-to]");if(i)return m(e),void De.goTo(parseFloat(i.dataset.carouselGoTo||"")||0);if(n.closest("[data-carousel-download]")){m(e);const n=null===(t=K[I])||void 0===t?void 0:t.slides[0];if(n&&(n.downloadSrc||"image"===n.type&&n.src)){const e=n.downloadFilename,t=document.createElement("a"),i=n.downloadSrc||n.src||"";t.href=i,t.target="_blank",t.download=e||i,t.click()}}else ie("click",e)}function Le(e){var t;const n=e.el;n&&(null===(t=n.querySelector(".f-spinner"))||void 0===t||t.remove())}function Ae(e){var t;const n=e.el;n&&(null===(t=n.querySelector(".f-html.is-error"))||void 0===t||t.remove(),d(n,"has-error"))}function Oe(e){var t;e||(e=null===(t=K[I])||void 0===t?void 0:t.slides[0]);const i=null==e?void 0:e.el;if(!i)return;let o=ee("formatCaption",e);void 0===o&&(o=e.caption),o=o||"";const s=ee("captionEl");if(s&&s instanceof HTMLElement){if(e.index!==I)return;if(n(o)&&(s.innerHTML=te(o+"")),o instanceof HTMLElement){if(o.parentElement===s)return;s.innerHTML="",o.parentElement&&(o=o.cloneNode(!0)),s.append(o)}return}if(!o)return;let r=e.captionEl||i.querySelector(".f-caption");!r&&o instanceof HTMLElement&&o.classList.contains("f-caption")&&(r=o),r||(r=document.createElement("div"),c(r,"f-caption"),n(o)?r.innerHTML=te(o+""):o instanceof HTMLElement&&(o.parentElement&&(o=o.cloneNode(!0)),r.append(o)));const l=`f-caption-${E}_${e.index}`;r.setAttribute("id",l),r.dataset.selectable="true",c(i,"has-caption"),i.setAttribute("aria-labelledby",l),e.captionEl=r,i.insertAdjacentElement("beforeend",r)}function Te(t,i={}){var o,r;let{transition:l,tween:u}=Object.assign({transition:T.transition,tween:T.tween},i||{});if(!V||!S)return;const f=K.length;if(!f)return;if(function(e,t){var i,o,s,r;if(!(V&&S&&t&&n(t)&&"tween"!==t))return!1;if((null===(i=K[I])||void 0===i?void 0:i.slides.length)>1)return!1;const l=K.length;let u=e>I?1:-1;e=D?(e%l+l)%l:a(0,e,l-1),$&&(u*=-1);const f=null===(o=K[I])||void 0===o?void 0:o.slides[0],v=null==f?void 0:f.index,p=null===(s=K[e])||void 0===s?void 0:s.slides[0],g=null==p?void 0:p.index,m=null===(r=K[e])||void 0===r?void 0:r.pos;if(void 0===g||void 0===v||v===g||k===m||Math.abs(ve()-((null==p?void 0:p.dim)||0))>1)return!1;F=!1,S.pause(),Se(),c(V,"in-transition"),k=B=m;const h=Ee(f),b=Ee(p);return ae(),h&&(W.add(v),h.style.transform="",h.addEventListener("animationend",je),d(h,T.classes.isSelected),h.inert=!1,c(h,`f-${t}Out to-${u>0?"next":"prev"}`)),b&&(W.add(g),b.style.transform="",b.addEventListener("animationend",je),c(b,T.classes.isSelected),b.inert=!1,c(b,`f-${t}In from-${u>0?"prev":"next"}`)),Re(),!0}(t,l))return;t=D?(t%f+f)%f:a(0,t,f-1),B=(null===(o=K[t||0])||void 0===o?void 0:o.pos)||0;const v=S.isRunning()?S.getEndValues().pos:k;if(Math.abs(B-v)<1)return k=B,I!==t&&(Oe(),ce(),de(),P=I,I=t,ie("change",I,P)),Re(),void(F||(F=!0,ie("settle")));if(S.pause(),Se(),D){const e=pe(),t=Math.floor((v-(null===(r=K[0])||void 0===r?void 0:r.pos))/e),n=B+t*e;B=[n+e,n,n-e].reduce((function(e,t){return Math.abs(t-v)<Math.abs(e-v)?t:e}))}!1!==l&&e(u)?S.spring(s({},T.tween,u)).from({pos:k}).to({pos:B}).start():(k=B,ae(),Re(),F||(F=!0,ie("settle")))}function Re(){var e;if(!V||!C)return;J=ge();const t=new Set,n=[],i=K[I],s=T.setTransform||void 0;let l;for(const o of Y){const s=W.has(o.index),r=J.indexOf(o)>-1,a=(null===(e=null==i?void 0:i.slides)||void 0===e?void 0:e.indexOf(o))>-1;if(o.isVirtual&&!s&&!r)continue;let c=Ee(o);if(c&&(n.push(o),a&&t.add(c),ee("adaptiveHeight")&&a)){const e=(c.firstElementChild||c).getBoundingClientRect().height;l=null==l?e:Math.max(l,e)}}C&&l&&(C.style.height=`${l}px`),[...o(C,`.${T.classes.slide}`)].forEach((e=>{u(e,T.classes.isSelected,t.has(e));const n=X[parseInt(e.getAttribute("index")||"-1")];if(!n)return e.remove(),void we(e);const i=W.has(n.index),o=J.indexOf(n)>-1;if(n.isVirtual&&!i&&!o)return void ye(n);e.inert=!o;let l=n.pos?Math.round(1e4*n.pos)/1e4:0,a=0,c=0,d=0,f=0;i||(a=z?0:$?-1*l:l,c=z?l:0,d=r(a,0,n.dim,0,100),f=r(c,0,n.dim,0,100)),s instanceof Function&&!i?s(De,n,{x:a,y:c,xPercent:d,yPercent:f}):e.style.transform=a||c?`translate3d(${d}%, ${f}%,0)`:""})),ie("render",n)}function Ve(){var e;null==V||V.removeEventListener("click",Pe),Se(),document.removeEventListener("mousemove",se),null==j||j.disconnect(),j=void 0;for(const n of X)n.el&&t(n.el)&&(n.state=void 0,Le(n),Ae(n),ye(n),n.isVirtual?(null===(e=n.el)||void 0===e||e.remove(),n.el=void 0):(n.el.style.transform="",null==C||C.appendChild(n.el)));for(const e of Object.values(R))null==e||e.destroy();R={},null==w||w.destroy(),w=void 0,null==S||S.destroy(),S=void 0;for(const[e,t]of Object.entries(T.classes||{}))"container"!==e&&d(V,t);d(C,"is-draggable")}function Ce(){return D||I>0}function He(){return D||I<K.length-1}const De={add:function(e,t){var n,i;let o=k;const s=I,r=pe(),l=(null==S?void 0:S.isRunning())?S.getEndValues().pos:k,a=Math.floor((l-(null===(n=K[0])||void 0===n?void 0:n.pos))/r);return me(e,t),le(G),Me(),S&&(s===I&&(o-=a*r),B=(null===(i=K[I||0])||void 0===i?void 0:i.pos)||0,o===B?k=B:S.spring({clamp:!0,mass:1,tension:300,friction:25,restDelta:1,restSpeed:1}).from({pos:o}).to({pos:B}).start()),Re(),De},canGoPrev:Ce,canGoNext:He,destroy:function(){return ie("destroy"),window.removeEventListener("resize",oe),Ve(),ne.clear(),V=null,K=[],X=[],T=Object.assign({},h),R={},Y=[],L="",G="*",A=2,De},emit:ie,filter:function(e="*"){return le(e),Me(),Re(),ie("filter",e),De},getContainer:function(){return V},getGapDim:fe,getGestures:function(){return w},getLastMouseMove:function(){return b},getOption:function(e){return ee(e)},getOptions:function(){return T},getPage:function(){return K[I]},getPageIndex:function(e){if(void 0!==e){for(const t of K||[])for(const n of t.slides)if(n.index===e)return t.index;return-1}return I},getPageProgress:function(e,t){var n;void 0===e&&(e=I);const i=K[e];if(!i)return e>I?-1:1;const o=pe(),s=fe();let r=i.pos,l=De.getPosition();if(D&&!0!==t){const e=Math.floor((l-(null===(n=K[0])||void 0===n?void 0:n.pos))/o);l-=e*o,r=[r+o,r,r-o].reduce((function(e,t){return Math.abs(t-l)<Math.abs(e-l)?t:e}))}return(l-r)/(i.dim+s)},getPageVisibility:function(e){var t;void 0===e&&(e=I);const n=K[e];if(!n)return e>I?-1:1;const i=De.getPosition(),o=ve();let s=n.pos;if(D){const e=De.getPosition(),n=pe(),i=s+Math.floor((e-(null===(t=K[0])||void 0===t?void 0:t.pos))/n)*n;s=[i+n,i,i-n].reduce((function(t,n){return Math.abs(n-e)<Math.abs(t-e)?n:t}))}return s>i&&s+n.dim<i+o?1:s<i?(s+n.dim-i)/n.dim:s+n.dim>i+o?(i+o-s)/n.dim:0},getPages:function(){return K},getPlugins:function(){return R},getPosition:function(e){var t;let n=k;if(D&&!0!==e){const e=pe();n-=Math.floor((k-(null===(t=K[0])||void 0===t?void 0:t.pos)||0)/e)*e}return n},getSlides:function(){return X},getState:function(){return A},getTotalSlideDim:pe,getTween:function(){return S},getViewport:function(){return C},getViewportDim:ve,getVisibleSlides:function(e){return void 0===e?J:ge(e)},goTo:Te,hasNavigated:function(){return void 0!==P},hideError:Ae,hideLoading:Le,init:function(){if(!g||!t(g))throw new Error("No Element found");return 0!==A&&(Ve(),A=0),V=g,O=x,window.removeEventListener("resize",oe),O.breakpoints&&window.addEventListener("resize",oe),oe(),De},isInfinite:function(){return D},isInTransition:function(){return W.size>0},isRTL:function(){return $},isSettled:function(){return F},isVertical:function(){return z},localize:function(e,t=[]){return te(e,t)},next:function(e={}){return Te(I+1,e),De},off:function(e,t){for(const n of e instanceof Array?e:[e])ne.has(n)&&ne.set(n,ne.get(n).filter((e=>e!==t)));return De},on:function(e,t){for(const n of e instanceof Array?e:[e])ne.set(n,[...ne.get(n)||[],t]);return De},prev:function(e={}){return Te(I-1,e),De},remove:function(e){void 0===e&&(e=X.length-1);const t=X[e];return t&&(ie("removeSlide",t),t.el&&(we(t.el),t.el.remove(),t.el=void 0),X.splice(e,1),le(G),Me(),Re()),De},setPosition:function(e){k=e,ae(),Re()},showError:function(e,t){Le(e),Ae(e);const n=e.el;if(n){const i=document.createElement("div");c(i,"f-html"),c(i,"is-error"),i.innerHTML=te(t||"<p>{{ERROR}}</p>"),e.htmlEl=i,c(n,"has-html"),c(n,"has-error"),n.insertAdjacentElement("afterbegin",i),ie("contentReady",e)}return De},showLoading:function(e){const t=e.el,n=null==t?void 0:t.querySelector(".f-spinner");if(!t||n)return De;const i=ee("spinnerTpl"),o=l(i);return o&&(c(o,"f-spinner"),t.insertAdjacentElement("beforeend",o)),De},version:"6.0.34"};return De};y.l10n={en_EN:g},y.getDefaults=()=>h;export{y as Carousel};
