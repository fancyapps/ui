/*! License details at fancyapps.com/license */
import{isPlainObject as t}from"../utils/isPlainObject.js";import{isNode as e}from"../utils/isNode.js";import{isString as n}from"../utils/isString.js";import{getScrollableParent as i}from"../utils/getScrollableParent.js";import{getDirectChildren as o}from"../utils/getDirectChildren.js";import{extend as s}from"../utils/extend.js";import{map as r}from"../utils/map.js";import{stringToHtml as l}from"../utils/strToHtml.js";import{clamp as a}from"../utils/clamp.js";import{addClass as c}from"../utils/addClass.js";import{removeClass as d}from"../utils/removeClass.js";import{toggleClass as u}from"../utils/toggleClass.js";import{Tween as f}from"../libs/tween.js";import{Gestures as v,isTouchEvent as p}from"../libs/gestures.js";import{en_EN as g}from"./l10n/en_EN.js";const m=t=>{t.cancelable&&t.preventDefault()},h={adaptiveHeight:!1,center:!0,classes:{container:"f-carousel",isEnabled:"is-enabled",isLTR:"is-ltr",isRTL:"is-rtl",isHorizontal:"is-horizontal",isVertical:"is-vertical",hasAdaptiveHeight:"has-adaptive-height",viewport:"f-carousel__viewport",slide:"f-carousel__slide",isSelected:"is-selected"},dragFree:!1,enabled:!0,errorTpl:'<div class="f-html">{{ERROR}}</div>',fill:!1,infinite:!0,initialPage:0,l10n:g,rtl:!1,slides:[],slidesPerPage:"auto",spinnerTpl:'<div class="f-spinner"></div>',transition:"fade",tween:{clamp:!0,mass:1,tension:160,friction:25,restDelta:1,restSpeed:1,velocity:0},vertical:!1};let b,E=0;const y=(g,x={},w={})=>{E++;let M,S,j,A,L,P=0,T=Object.assign({},h),O=Object.assign({},h),R={},V=null,C=null,H=!1,D=!1,$=!1,q=!1,I="height",F=0,z=!0,k=0,B=0,N=0,_=0,G="*",X=[],Y=[];const W=new Set;let J=[],K=[],Q=0,U=0,Z=0;function tt(t,...e){let n=O[t];return n&&n instanceof Function?n($t,...e):n}function et(t,e=[]){const n=tt("l10n")||{};t=String(t).replace(/\{\{(\w+)\}\}/g,((t,e)=>n[e]||t));for(let n=0;n<e.length;n++)t=t.split(e[n][0]).join(e[n][1]);return t=t.replace(/\{\{(.*?)\}\}/g,((t,e)=>e))}const nt=new Map;function it(t,...e){const n=[...nt.get(t)||[]];O.on&&n.push(O.on[t]);for(const t of n)t&&t instanceof Function&&t($t,...e);"*"!==t&&it("*",t,...e)}function ot(){var e,n;const i=s({},h,T);s(i,h,T);let r="";const l=T.breakpoints||{};if(l)for(const[t,e]of Object.entries(l))window.matchMedia(t).matches&&(r+=t,s(i,e));if(void 0===L||r!==L){if(L=r,0!==P){let t=null===(n=null===(e=K[k])||void 0===e?void 0:e.slides[0])||void 0===n?void 0:n.index;void 0===t&&(t=O.initialSlide),i.initialSlide=t,i.slides=[];for(const t of X)t.isVirtual&&i.slides.push(t)}Ct(),O=i,!1!==tt("enabled")&&(P=0,it("init"),function(){for(const[t,e]of Object.entries(Object.assign(Object.assign({},w),O.plugins||{})))if(t&&!R[t]&&e instanceof Function){const n=e();n.init($t,y),R[t]=n}it("initPlugins")}(),function(){if(!V)return;const e=tt("classes")||{};c(V,e.container);const n=tt("style");if(n&&t(n))for(const[t,e]of Object.entries(n))V.style.setProperty(t,e);C=V.querySelector(`.${e.viewport}`),C||(C=document.createElement("div"),c(C,e.viewport),C.append(...o(V,`.${e.slide}`)),V.insertAdjacentElement("afterbegin",C)),V.carousel=$t,it("initLayout")}(),function(){if(!C)return;const t=tt("classes")||{};X=[],[...o(C,`.${t.slide}`)].forEach((t=>{if(t.parentElement){const e=ht(Object.assign({el:t,isVirtual:!1},t.dataset||{}));it("createSlide",e),X.push(e)}})),xt();for(const t of X)it("addSlide",t);mt(tt("slides"));for(const t of X){const e=t.el;(null==e?void 0:e.parentElement)===C&&(c(e,O.classes.slide),c(e,t.class),Tt(t),it("attachSlideEl",t))}it("initSlides")}(),wt(),P=1,c(V,(tt("classes")||{}).isEnabled||""),Vt(),ct(),S=f().on("start",(()=>{M&&M.isPointerDown()||(at(),Vt())})).on("step",(t=>{const e=F;F=t.pos,F!==e&&(z=!1,Vt())})).on("end",(t=>{(null==M?void 0:M.isPointerDown())||(F=t.pos,S&&!D&&(F<N||F>_)?S.spring({clamp:!0,mass:1,tension:200,friction:25,velocity:0,restDelta:1,restSpeed:1}).from({pos:F}).to({pos:a(N,F,_)}).start():z||(z=!0,it("settle")))})),rt(),function(){if(V&&C&&(V.addEventListener("click",At,{passive:!1}),document.addEventListener("mousemove",st),!j)){let t=!0,e=null;j=new ResizeObserver((()=>{if(t){if(C){const t=C.getBoundingClientRect();Q=t.height,U=t.width}t=!1}else e||(e=requestAnimationFrame((()=>{!function(){if(1!==P||!C)return;const t=K.length;wt(),rt();const e=C.getBoundingClientRect(),n=e.height,i=e.width;t>1&&(q&&Math.abs(n-Q)<.5||!q&&Math.abs(i-U)<.5)||(Q=n,U=i,q&&!n||!q&&!i||V&&C&&(t===K.length&&(null==M?void 0:M.isPointerDown())||(tt("dragFree")&&(D||F>N&&F<_)?(at(),Vt()):Ot(k,{transition:!1}))))}(),e=null})))})),j.observe(C)}}(),it("ready"))}}function st(t){b=t}function rt(){if(!C)return;const t=tt("gestures");!1!==t?M||(M=v(C,t).on("start",(t=>{var e,n;if(!S)return;const{srcEvent:o}=t;q&&p(o)&&!i(o.target)&&m(o),S.pause(),S.getCurrentVelocities().pos=0;const s=null===(e=K[k])||void 0===e?void 0:e.slides[0];if(s&&W.has(s.index)&&s.el&&(F=s.offset||0,F+=(function(t){const e=window.getComputedStyle(t),n=new DOMMatrixReadOnly(e.transform);return{width:n.m41||0,height:n.m42||0}}(s.el)[I]||0)*($&&!q?1:-1)),St(),!D){(F<N||F>_)&&S.spring({clamp:!0,mass:1,tension:500,friction:25,velocity:(null===(n=S.getCurrentVelocities())||void 0===n?void 0:n.pos)||0,restDelta:1,restSpeed:1}).from({pos:F}).to({pos:a(N,F,_)}).start()}})).on("move",(t=>{var e,n;const{srcEvent:o,axis:s}=t,r=o.target;if(s||(m(o),o.stopPropagation(),o.stopImmediatePropagation()),("y"===s&&q||"x"===s&&!q)&&(m(o),o.stopPropagation()),!s)return;const{deltaX:l,deltaY:a}=t;if(!S)return;if(p(o)&&(null===(e=o.touches)||void 0===e?void 0:e.length)>1)return;if("y"===s&&!q||"x"===s&&q)return;if(r&&i(r)&&("x"!==s||q))return;const c=$&&!q?1:-1;let d=q?a:l,u=(null==S?void 0:S.isRunning())?S.getEndValues().pos:F,f=1;D||(u<=N&&d*c<0?(f=Math.max(.01,1-(Math.abs(1/vt()*Math.abs(u-N))||0)),f*=.2):u>=_&&d*c>0&&(f=Math.max(.01,1-(Math.abs(1/vt()*Math.abs(u-_))||0)),f*=.2)),u+=d*f*c,S.spring({clamp:!0,mass:1,tension:700,friction:25,velocity:(null===(n=S.getCurrentVelocities())||void 0===n?void 0:n.pos)||0,restDelta:1,restSpeed:1}).from({pos:F}).to({pos:u}).start()})).on("panstart",(t=>{(null==t?void 0:t.axis)===(q?"y":"x")&&c(C,"is-dragging")})).on("panend",(()=>{d(C,"is-dragging")})).on("end",(t=>{var e,n;const{srcEvent:o,axis:s,velocityX:r,velocityY:l,currentTouch:c}=t;if(c.length>0||!S)return;const d=o.target,u=d&&i(d)&&!("x"===s&&!q);q&&p(o)&&!t.axis&&At(o);const f=K.length,v=tt("dragFree");if(!f)return;const g=tt("vertical")?l:r;let m=(null==S?void 0:S.isRunning())?S.getEndValues().pos:F;const h=$&&!q?1:-1;if(u||(m+=g*(v?5:1)*h),!D&&(g*h<=0&&m<N||g*h>=0&&m>_)){let t=0;return Math.abs(g)>0&&(t=2*Math.abs(g),t=Math.min(.3*vt(),t)),m=a(N+-1*t,m,_+t),void S.spring({clamp:!0,mass:1,tension:380,friction:25,velocity:-1*g,restDelta:1,restSpeed:1}).from({pos:F}).to({pos:m}).start()}if(v||(null===(e=R.Autoscroll)||void 0===e?void 0:e.isEnabled()))return void(Math.abs(g)>10?S.spring({clamp:!0,mass:1,tension:150,friction:25,velocity:-1*g,restDelta:1,restSpeed:1}).from({pos:F}).to({pos:m}).start():S.isRunning()||z||(z=!0,it("settle")));if(!v&&!(null===(n=R.Autoscroll)||void 0===n?void 0:n.isEnabled())&&(!t.offsetX&&!t.offsetY||"y"===s&&!q||"x"===s&&q))return void Ot(k,{transition:"tween"});let b=ut(m);Math.abs(g)>10&&b===k&&(b+=g>0?$&&!q?1:-1:$&&!q?-1:1),Ot(b,{transition:"tween",tween:{velocity:-1*g}})})).init()):M&&(M.destroy(),M=void 0)}function lt(t="*"){var e;const n=[];for(const i of X)("*"===t||i.class&&i.class.includes(t)||i.el&&(null===(e=i.el)||void 0===e?void 0:e.classList.contains(t)))&&n.push(i);A=void 0,G=t,Y=[...n]}function at(){if(!S)return;const t=ut((null==S?void 0:S.isRunning())?S.getEndValues().pos:F);t!==k&&(A=k,k=t,Tt(),ct(),dt(),it("change",k,A))}function ct(){var t,e;if(!V)return;u(C,"is-draggable",!!M&&K.length>0);for(const t of V.querySelectorAll("[data-carousel-index]"))t.innerHTML=k+"";for(const t of V.querySelectorAll("[data-carousel-page]"))t.innerHTML=k+1+"";for(const t of V.querySelectorAll("[data-carousel-pages]"))t.innerHTML=K.length+"";for(const e of V.querySelectorAll("[data-carousel-go-to]")){parseInt((null===(t=e.dataset)||void 0===t?void 0:t.carouselGoTo)||"-1",10)===k?e.setAttribute("aria-current","true"):e.removeAttribute("aria-current")}for(const t of V.querySelectorAll("[data-carousel-go-prev]"))t.toggleAttribute("aria-disabled",!Ht()),Ht()?t.removeAttribute("tabindex"):t.setAttribute("tabindex","-1");for(const t of V.querySelectorAll("[data-carousel-go-next]"))t.toggleAttribute("aria-disabled",!Dt()),Dt()?t.removeAttribute("tabindex"):t.setAttribute("tabindex","-1");let n=!1;const i=null===(e=K[k])||void 0===e?void 0:e.slides[0];i&&(i.downloadSrc||"image"===i.type&&i.src)&&(n=!0);for(const t of V.querySelectorAll("[data-carousel-download]"))t.toggleAttribute("aria-disabled",!n)}function dt(t){var e;t||(t=null===(e=K[k])||void 0===e?void 0:e.slides[0]);const n=null==t?void 0:t.el;if(n)for(const e of n.querySelectorAll("[data-slide-index]"))e.innerHTML=t.index+1+""}function ut(t){var e,n,i;if(!K.length)return 0;const o=pt();let s=t;D?s-=Math.floor((t-(null===(e=K[0])||void 0===e?void 0:e.pos))/o)*o||0:s=a(null===(n=K[0])||void 0===n?void 0:n.pos,t,null===(i=K[K.length-1])||void 0===i?void 0:i.pos);const r=new Map;let l=0;for(const t of K){const e=Math.abs(t.pos-s),n=Math.abs(t.pos-s-o),i=Math.abs(t.pos-s+o),a=Math.min(e,n,i);r.set(l,a),l++}const c=r.size>0?[...r.entries()].reduce(((t,e)=>e[1]<t[1]?e:t)):[k,0];return parseInt(c[0])}function ft(){return Z}function vt(){let t=0;return C&&(C.childElementCount||(C.style.display="grid"),t=C.getBoundingClientRect()[I]||0,C.style.display=""),t}function pt(t=!0){return Y.length?Y.reduce(((t,e)=>t+e.dim),0)+(Y.length-(D&&t?0:1))*Z:0}function gt(t){const e=pt(),n=vt();if(!e||!C||!n)return[];const i=[];t=void 0===t?F:t,D&&(t-=Math.floor(t/e)*e||0);let o=0,s=0;if(H){const t=C.getBoundingClientRect();o=Math.abs(t[q?"top":"left"]),s=Math.abs(window[q?"innerHeight":"innerWidth"]-t[q?"bottom":"right"])}let r=0;for(let l of Y){const a=(e=0)=>{i.indexOf(l)>-1||(l.pos=r-t+e||0,l.offset+e>t-l.dim-o+.51&&l.offset+e<t+n+s-.51&&i.push(l))};l.offset=r,D&&(a(e),a(-1*e)),a(),r+=l.dim+Z}return i}function mt(t,e){const n=[];for(const e of Array.isArray(t)?t:[t]){const t=ht(Object.assign(Object.assign({},e),{isVirtual:!0}));t.el||(t.el=document.createElement("div")),it("createSlide",t),n.push(t)}X.splice(void 0===e?X.length:e,0,...n),xt();for(const t of n)it("addSlide",t),bt(t);return lt(G),n}function ht(t){return(n(t)||t instanceof HTMLElement)&&(t={html:t}),Object.assign({index:-1,el:void 0,class:"",isVirtual:!0,dim:0,pos:0,offset:0,html:"",src:""},t)}function bt(t){let e=t.el;if(!t||!e)return;const n=t.html?t.html instanceof HTMLElement?t.html:l(t.html):void 0;n&&(c(n,"f-html"),t.htmlEl=n,c(e,"has-html"),e.append(n),it("contentReady",t))}function Et(t){if(!C||!t)return;let e=t.el;if(e){if(e.setAttribute("index",t.index+""),e.parentElement!==C){let n;c(e,O.classes.slide),c(e,t.class),Tt(t);for(const e of X)if(e.index>t.index){n=e.el;break}C.insertBefore(e,n&&C.contains(n)?n:null),it("attachSlideEl",t)}return dt(t),e}}function yt(t){const e=null==t?void 0:t.el;e&&(e.remove(),Mt(e),it("detachSlideEl",t))}function xt(){for(let t=0;t<X.length;t++){const e=X[t],n=e.el;n&&(e.index!==t&&Mt(n),n.setAttribute("index",`${t}`)),e.index=t}}function wt(){var t,n,i,o,s;if(!V||!C)return;$=tt("rtl"),q=tt("vertical"),I=q?"height":"width";const r=tt("classes");if(u(V,r.isLTR,!$),u(V,r.isRTL,$),u(V,r.isHorizontal,!q),u(V,r.isVertical,q),u(V,r.hasAdaptiveHeight,tt("adaptiveHeight")),!vt())return;const l=window.getComputedStyle(C);H="visible"===l.getPropertyValue("overflow-"+(q?"y":"x")),Z=C&&parseFloat(l.getPropertyValue("--f-carousel-gap"))||0;const d=function(){let t=0;if(C){let e=document.createElement("div");e.style.display="block",c(e,O.classes.slide),C.appendChild(e),t=e.getBoundingClientRect()[I],e.remove(),e=void 0}return t}();for(const n of Y){const i=n.el;let o=0;if(!n.isVirtual&&i&&e(i)){let e=!1;i.parentElement&&i.parentElement===C||(C.appendChild(i),e=!0),o=i.getBoundingClientRect()[I],e&&(null===(t=i.parentElement)||void 0===t||t.removeChild(i))}else o=d;n.dim=o}if(D=!1,tt("infinite")){D=!0;const t=pt();let e=vt();if(H){const t=C.getBoundingClientRect();e+=t.left,e+=t.right-t.width}for(let i=0;i<Y.length;i++){const o=(null===(n=Y[i])||void 0===n?void 0:n.dim)+Z;if(t-o<e&&t-o-e<o){D=!1;break}}}if(function(){var t;if(!V)return;const e=vt(),n=pt(!1);let i=tt("slidesPerPage");i="auto"===i?1/0:parseFloat(i+""),K=[];let o=0,s=0;for(const n of Y)(!K.length||o+n.dim-e>.05||s>=i)&&(K.push({index:K.length,slides:[],dim:0,offset:0,pos:0}),o=0,s=0),null===(t=K[K.length-1])||void 0===t||t.slides.push(n),o+=n.dim+Z,s++;const r=tt("center"),l=tt("fill");let c=0;for(const t of K){t.dim=(t.slides.length-1)*Z;for(const e of t.slides)t.dim+=e.dim;t.offset=c,t.pos=c,!1!==r&&(t.pos-=.5*(e-t.dim)),l&&!D&&n>e&&(t.pos=a(0,t.pos,n-e)),c+=t.dim+Z}const d=[];let u;for(const t of K){const e=Object.assign({},t);u&&Math.abs(e.pos-u.pos)<.1?(u.dim+=e.dim,u.slides=[...u.slides,...e.slides]):(u=e,e.index=d.length,d.push(e))}K=d,k=a(0,k,K.length-1)}(),N=(null===(i=K[0])||void 0===i?void 0:i.pos)||0,_=(null===(o=K[K.length-1])||void 0===o?void 0:o.pos)||0,0===P)!function(){var t;A=void 0,k=tt("initialPage");const e=tt("initialSlide")||void 0;void 0!==e&&(k=$t.getPageIndex(e)||0),k=a(0,k,K.length-1),F=(null===(t=K[k])||void 0===t?void 0:t.pos)||0,B=F}();else{const t=(null==S?void 0:S.isRunning())?S.getEndValues().pos:F;(t<N||t>_)&&(B=(null===(s=K[k||0])||void 0===s?void 0:s.pos)||0,F=a(N,F,_))}it("refresh"),ct()}function Mt(t){if(!t||!e(t))return;const n=parseInt(t.getAttribute("index")||"-1");let i="";for(const e of Array.from(t.classList)){const t=e.match(/^f-(\w+)(Out|In)$/);t&&t[1]&&(i=t[1]+"")}if(!t||!i)return;const o=[`f-${i}Out`,`f-${i}In`,"to-prev","to-next","from-prev","from-next"];t.removeEventListener("animationend",jt),d(t,o.join(" ")),W.delete(n)}function St(){if(!C)return;const t=W.size>0;for(const t of Y)Mt(t.el);W.clear(),t&&Vt()}function jt(t){var e;"f-"===(null===(e=t.animationName)||void 0===e?void 0:e.substring(0,2))&&(Mt(t.target),W.size||(d(V,"in-transition"),!z&&Math.abs($t.getPosition(!0)-B)<.5&&(z=!0,it("settle"))),Vt())}function At(t){var e;if(t.defaultPrevented)return;const n=t.composedPath()[0];if(n.closest("[data-carousel-go-prev]"))return m(t),void $t.prev();if(n.closest("[data-carousel-go-next]"))return m(t),void $t.next();const i=n.closest("[data-carousel-go-to]");if(i)return m(t),void $t.goTo(parseFloat(i.dataset.carouselGoTo||"")||0);if(n.closest("[data-carousel-download]")){m(t);const n=null===(e=K[k])||void 0===e?void 0:e.slides[0];if(n&&(n.downloadSrc||"image"===n.type&&n.src)){const t=n.downloadFilename,e=document.createElement("a"),i=n.downloadSrc||n.src||"";e.href=i,e.target="_blank",e.download=t||i,e.click()}}else it("click",t)}function Lt(t){var e;const n=t.el;n&&(null===(e=n.querySelector(".f-spinner"))||void 0===e||e.remove())}function Pt(t){var e;const n=t.el;n&&(null===(e=n.querySelector(".f-html.is-error"))||void 0===e||e.remove(),d(n,"has-error"))}function Tt(t){var e;t||(t=null===(e=K[k])||void 0===e?void 0:e.slides[0]);const i=null==t?void 0:t.el;if(!i)return;let o=tt("formatCaption",t);void 0===o&&(o=t.caption),o=o||"";const s=tt("captionEl");if(s&&s instanceof HTMLElement){if(t.index!==k)return;if(n(o)&&(s.innerHTML=et(o+"")),o instanceof HTMLElement){if(o.parentElement===s)return;s.innerHTML="",o.parentElement&&(o=o.cloneNode(!0)),s.append(o)}return}if(!o)return;let r=t.captionEl||i.querySelector(".f-caption");!r&&o instanceof HTMLElement&&o.classList.contains("f-caption")&&(r=o),r||(r=document.createElement("div"),c(r,"f-caption"),n(o)?r.innerHTML=et(o+""):o instanceof HTMLElement&&(o.parentElement&&(o=o.cloneNode(!0)),r.append(o)));const l=`f-caption-${E}_${t.index}`;r.setAttribute("id",l),r.dataset.selectable="true",c(i,"has-caption"),i.setAttribute("aria-labelledby",l),t.captionEl=r,i.insertAdjacentElement("beforeend",r)}function Ot(e,i={}){var o,r;let{transition:l,tween:u}=Object.assign({transition:O.transition,tween:O.tween},i||{});if(!V||!S)return;const f=K.length;if(!f)return;if(function(t,e){var i,o,s,r;if(!(V&&S&&e&&n(e)&&"tween"!==e))return!1;if((null===(i=K[k])||void 0===i?void 0:i.slides.length)>1)return!1;const l=K.length;let u=t>k?1:-1;t=D?(t%l+l)%l:a(0,t,l-1),$&&(u*=-1);const f=null===(o=K[k])||void 0===o?void 0:o.slides[0],v=null==f?void 0:f.index,p=null===(s=K[t])||void 0===s?void 0:s.slides[0],g=null==p?void 0:p.index,m=null===(r=K[t])||void 0===r?void 0:r.pos;if(void 0===g||void 0===v||v===g||F===m||Math.abs(vt()-((null==p?void 0:p.dim)||0))>1)return!1;z=!1,S.pause(),St(),c(V,"in-transition"),F=B=m;const h=Et(f),b=Et(p);return at(),h&&(W.add(v),h.style.transform="",h.addEventListener("animationend",jt),d(h,O.classes.isSelected),h.inert=!1,c(h,`f-${e}Out to-${u>0?"next":"prev"}`)),b&&(W.add(g),b.style.transform="",b.addEventListener("animationend",jt),c(b,O.classes.isSelected),b.inert=!1,c(b,`f-${e}In from-${u>0?"prev":"next"}`)),Vt(),!0}(e,l))return;e=D?(e%f+f)%f:a(0,e,f-1);const v=(null===(o=K[e||0])||void 0===o?void 0:o.pos)||0;B=v;const p=S.isRunning()?S.getEndValues().pos:F;if(Math.abs(B-p)<1)return F=B,k!==e&&(Tt(),A=k,k=e,ct(),dt(),it("change",k,A)),Vt(),void(z||(z=!0,it("settle")));if(S.pause(),St(),D){const t=pt(),e=Math.floor((p-(null===(r=K[0])||void 0===r?void 0:r.pos))/t)||0,n=B+e*t;B=[n+t,n,n-t].reduce((function(t,e){return Math.abs(e-p)<Math.abs(t-p)?e:t}))}!1!==l&&t(u)?S.spring(s({},O.tween,u)).from({pos:F}).to({pos:B}).start():(F=B,at(),Vt(),z||(z=!0,it("settle")))}function Rt(t){var e;let n=F;if(D&&!0!==t){const t=pt();n-=(Math.floor((F-(null===(e=K[0])||void 0===e?void 0:e.pos)||0)/t)||0)*t}return n}function Vt(){var t;if(!V||!C)return;J=gt();const e=new Set,n=[],i=K[k],s=O.setTransform;let l;for(const o of Y){const s=W.has(o.index),r=J.indexOf(o)>-1,a=(null===(t=null==i?void 0:i.slides)||void 0===t?void 0:t.indexOf(o))>-1;if(o.isVirtual&&!s&&!r)continue;let c=Et(o);if(c&&(n.push(o),a&&e.add(c),tt("adaptiveHeight")&&a)){const t=(c.firstElementChild||c).getBoundingClientRect().height;l=null==l?t:Math.max(l,t)}}C&&l&&(C.style.height=`${l}px`),[...o(C,`.${O.classes.slide}`)].forEach((t=>{u(t,O.classes.isSelected,e.has(t));const n=X[parseInt(t.getAttribute("index")||"-1")];if(!n)return t.remove(),void Mt(t);const i=W.has(n.index),o=J.indexOf(n)>-1;if(n.isVirtual&&!i&&!o)return void yt(n);if(t.inert=!o,!1===s)return;let l=n.pos?Math.round(1e4*n.pos)/1e4:0,a=0,c=0,d=0,f=0;i||(a=q?0:$?-1*l:l,c=q?l:0,d=r(a,0,n.dim,0,100),f=r(c,0,n.dim,0,100)),s instanceof Function&&!i?s($t,n,{x:a,y:c,xPercent:d,yPercent:f}):t.style.transform=a||c?`translate3d(${d}%, ${f}%,0)`:""})),it("render",n)}function Ct(){null==V||V.removeEventListener("click",At),W.clear(),document.removeEventListener("mousemove",st),null==j||j.disconnect(),j=void 0;for(const t of X){let n=t.el;n&&e(n)&&(t.state=void 0,Lt(t),Pt(t),t.isVirtual?(yt(t),t.el=void 0):(Mt(n),n.style.transform="",C&&!C.contains(n)&&C.appendChild(n)))}for(const t of Object.values(R))null==t||t.destroy();R={},null==M||M.destroy(),M=void 0,null==S||S.destroy(),S=void 0;for(const[t,e]of Object.entries(O.classes||{}))"container"!==t&&d(V,e);d(C,"is-draggable")}function Ht(){return D||k>0}function Dt(){return D||k<K.length-1}const $t={add:function(t,e){var n,i;let o=F;const s=k,r=pt(),l=(null==S?void 0:S.isRunning())?S.getEndValues().pos:F,a=r&&Math.floor((l-((null===(n=K[0])||void 0===n?void 0:n.pos)||0))/r)||0;return mt(t,e),lt(G),wt(),S&&r&&(s===k&&(o-=a*r),B=(null===(i=K[k||0])||void 0===i?void 0:i.pos)||0,o===B?F=B:S.spring({clamp:!0,mass:1,tension:300,friction:25,restDelta:1,restSpeed:1}).from({pos:o}).to({pos:B}).start()),Vt(),$t},canGoPrev:Ht,canGoNext:Dt,destroy:function(){return it("destroy"),window.removeEventListener("resize",ot),Ct(),nt.clear(),V=null,K=[],X=[],O=Object.assign({},h),R={},Y=[],L=void 0,G="*",P=2,$t},emit:it,filter:function(t="*"){return lt(t),wt(),Vt(),it("filter",t),$t},getContainer:function(){return V},getGapDim:ft,getGestures:function(){return M},getLastMouseMove:function(){return b},getOption:function(t){return tt(t)},getOptions:function(){return O},getPage:function(){return K[k]},getPageIndex:function(t){if(void 0!==t){for(const e of K||[])for(const n of e.slides)if(n.index===t)return e.index;return-1}return k},getPageIndexFromPosition:ut,getPageProgress:function(t,e){var n;void 0===t&&(t=k);const i=K[t];if(!i)return t>k?-1:1;const o=pt(),s=ft();let r=i.pos,l=Rt();if(D&&!0!==e){const t=Math.floor((l-(null===(n=K[0])||void 0===n?void 0:n.pos))/o)||0;l-=t*o,r=[r+o,r,r-o].reduce((function(t,e){return Math.abs(e-l)<Math.abs(t-l)?e:t}))}return(l-r)/(i.dim+s)||0},getPageVisibility:function(t){var e;void 0===t&&(t=k);const n=K[t];if(!n)return t>k?-1:1;const i=Rt(),o=vt();let s=n.pos;if(D){const t=pt(),n=s+(Math.floor((i-(null===(e=K[0])||void 0===e?void 0:e.pos))/t)||0)*t;s=[n+t,n,n-t].reduce((function(t,e){return Math.abs(e-i)<Math.abs(t-i)?e:t}))}return s>i&&s+n.dim<i+o?1:s<i?(s+n.dim-i)/n.dim||0:s+n.dim>i+o&&(i+o-s)/n.dim||0},getPages:function(){return K},getPlugins:function(){return R},getPosition:Rt,getSlides:function(){return X},getState:function(){return P},getTotalSlideDim:pt,getTween:function(){return S},getViewport:function(){return C},getViewportDim:vt,getVisibleSlides:function(t){return void 0===t?J:gt(t)},goTo:Ot,hasNavigated:function(){return void 0!==A},hideError:Pt,hideLoading:Lt,init:function(){if(!g||!e(g))throw new Error("No Element found");return 0!==P&&(Ct(),P=0),V=g,T=x,window.removeEventListener("resize",ot),T.breakpoints&&window.addEventListener("resize",ot),ot(),$t},isInfinite:function(){return D},isInTransition:function(){return W.size>0},isRTL:function(){return $},isSettled:function(){return z},isVertical:function(){return q},localize:function(t,e=[]){return et(t,e)},next:function(t={}){return Ot(k+1,t),$t},off:function(t,e){for(const n of t instanceof Array?t:[t])nt.has(n)&&nt.set(n,nt.get(n).filter((t=>t!==e)));return $t},on:function(t,e){for(const n of t instanceof Array?t:[t])nt.set(n,[...nt.get(n)||[],e]);return $t},prev:function(t={}){return Ot(k-1,t),$t},reInit:function(t={},e={}){return Ct(),P=0,L=void 0,G="*",x=t,T=t,w=e,ot(),$t},remove:function(t){void 0===t&&(t=X.length-1);const e=X[t];return e&&(it("removeSlide",e),e.el&&(Mt(e.el),e.el.remove(),e.el=void 0),X.splice(t,1),lt(G),wt(),Vt()),$t},setPosition:function(t){F=t,at(),Vt()},showError:function(t,e){Lt(t),Pt(t);const n=t.el;if(n){const i=document.createElement("div");c(i,"f-html"),c(i,"is-error"),i.innerHTML=et(e||"<p>{{ERROR}}</p>"),t.htmlEl=i,c(n,"has-html"),c(n,"has-error"),n.insertAdjacentElement("afterbegin",i),it("contentReady",t)}return $t},showLoading:function(t){const e=t.el,n=null==e?void 0:e.querySelector(".f-spinner");if(!e||n)return $t;const i=tt("spinnerTpl"),o=l(i);return o&&(c(o,"f-spinner"),e.insertAdjacentElement("beforeend",o)),$t},version:"6.1.1"};return $t};y.l10n={en_EN:g},y.getDefaults=()=>h;export{y as Carousel};
