/*! License details at fancyapps.com/license */
import{isPlainObject as e}from"../utils/isPlainObject.js";import{isString as t}from"../utils/isString.js";import{isNode as n}from"../utils/isNode.js";import{stringToHtml as o}from"../utils/strToHtml.js";import{getScrollableParent as i}from"../utils/getScrollableParent.js";import{scrollLock as s}from"../utils/scrollLock.js";import{extend as l}from"../utils/extend.js";import{canUseDOM as r}from"../utils/canUseDOM.js";import{map as a}from"../utils/map.js";import{addClass as c}from"../utils/addClass.js";import{removeClass as u}from"../utils/removeClass.js";import{toggleClass as d}from"../utils/toggleClass.js";import{Tween as f}from"../libs/tween.js";import{Gestures as m,isTouchEvent as g}from"../libs/gestures.js";import{PANZOOM_DEFAULT_POS as p,PanzoomAction as v}from"../panzoom/panzoom.js";export{Panzoom,PanzoomZoomLevel}from"../panzoom/panzoom.js";import{Carousel as y}from"../carousel/carousel.js";import{Zoomable as h}from"../carousel/carousel.zoomable.js";import{Sync as b}from"../carousel/carousel.sync.js";import{Lazyload as E}from"../carousel/carousel.lazyload.js";import{Arrows as x}from"../carousel/carousel.arrows.js";import{Toolbar as w}from"../carousel/carousel.toolbar.js";export{ToolbarColumn}from"../carousel/carousel.toolbar.js";import{Autoplay as L}from"../carousel/carousel.autoplay.js";import{Thumbs as j}from"../carousel/carousel.thumbs.js";import{Html as S}from"../carousel/carousel.html.js";import{Video as P}from"../carousel/carousel.video.js";import{Fullscreen as T}from"../carousel/carousel.fullscreen.js";import{Hash as C}from"./fancybox.hash.js";import{en_EN as M}from"./l10n/en_EN.js";const A='<button class="f-button" title="{{CLOSE}}" data-fancybox-close><svg tabindex="-1" width="24" height="24" viewBox="0 0 24 24"><path d="M19.286 4.714 4.714 19.286M4.714 4.714l14.572 14.572" /></svg></button>';w().add("close",{tpl:A});const k=e=>{e.cancelable&&e.preventDefault()};const R=(e=null,t="",n)=>{if(!e||!e.parentElement||!t)return void(n&&n());O(e);const o=i=>{i.target===e&&e.dataset.animationName&&(e.removeEventListener("animationend",o),delete e.dataset.animationName,n&&n(),e.classList.remove(t))};e.dataset.animationName=t,e.addEventListener("animationend",o),c(e,t)},O=e=>{e&&e.dispatchEvent(new CustomEvent("animationend",{bubbles:!1,cancelable:!0,currentTarget:e}))};var _;!function(e){e[e.Init=0]="Init",e[e.Ready=1]="Ready",e[e.Closing=2]="Closing",e[e.Destroyed=3]="Destroyed"}(_||(_={}));const I={ajax:null,backdropClick:"close",Carousel:{},closeButton:"auto",closeButtonTpl:A,closeExisting:!1,delegateEl:void 0,dragToClose:!0,fadeEffect:!0,groupAll:!1,groupAttr:"data-fancybox",hideClass:"f-fadeOut",hideScrollbar:!0,id:void 0,idle:!1,keyboard:{Escape:"close",Delete:"close",Backspace:"close",PageUp:"next",PageDown:"prev",ArrowUp:"prev",ArrowDown:"next",ArrowRight:"next",ArrowLeft:"prev"},l10n:M,mainClass:"",mainStyle:{},mainTpl:'<dialog class="fancybox__dialog">\n    <div class="fancybox__container" tabindex="0" aria-label="{{MODAL}}">\n      <div class="fancybox__backdrop"></div>\n      <div class="fancybox__carousel"></div>\n    </div>\n  </dialog>',modal:!0,on:{},parentEl:void 0,placeFocusBack:!0,showClass:"f-zoomInUp",startIndex:0,sync:void 0,theme:"dark",triggerEl:void 0,triggerEvent:void 0,zoomEffect:!0},z=new Map;let H=0;const B="with-fancybox",D=()=>{let r,C,M,A,D,q,N,V=_.Init,W=Object.assign({},I),$=-1,K={},U=[],X=!1,G=!0,Y=0;function Z(e,...t){let n=W[e];return n&&"function"==typeof n?n(Re,...t):n}function J(e,t=[]){const n=Z("l10n")||{};e=String(e).replace(/\{\{(\w+)\}\}/g,(e,t)=>n[t]||e);for(let n=0;n<t.length;n++)e=e.split(t[n][0]).join(t[n][1]);return e=e.replace(/\{\{(.*?)\}\}/g,(e,t)=>t)}const Q=new Map;function ee(e,...t){const n=[...Q.get(e)||[]];for(const[t,o]of Object.entries(W.on||{}))(t===e||t.split(" ").indexOf(e)>-1)&&n.push(o);for(const e of n)e&&"function"==typeof e&&e(Re,...t);"*"!==e&&ee("*",e,...t)}function te(){u(C,"is-revealing");try{if(document.activeElement===r){((null==C?void 0:C.querySelector("[autofocus]"))||C).focus()}}catch(e){}}function ne(e,n){var o;ve(n),de(),null===(o=n.el)||void 0===o||o.addEventListener("click",ie),"inline"!==n.type&&"clone"!==n.type||function(e){if(!A||!e||!e.el)return;let n=null;if(t(e.src)){const t=e.src.split("#",2).pop();n=t?document.getElementById(t):null}if(n){if(c(n,"f-html"),"clone"===e.type||n.closest(".fancybox__carousel")){n=n.cloneNode(!0);const t=n.dataset.animationName;t&&(n.classList.remove(t),delete n.dataset.animationName);let o=n.getAttribute("id");o=o?`${o}--clone`:`clone-${$}-${e.index}`,n.setAttribute("id",o)}else if(n.parentNode){const t=document.createElement("div");t.inert=!0,n.parentNode.insertBefore(t,n),e.placeholderEl=t}e.htmlEl=n,c(e.el,"has-html"),e.el.prepend(n),n.classList.remove("hidden"),"none"===n.style.display&&(n.style.display=""),"none"===getComputedStyle(n).getPropertyValue("display")&&(n.style.display=n.dataset.display||"flex"),null==A||A.emit("contentReady",e)}else null==A||A.showError(e,"{{ELEMENT_NOT_FOUND}}")}(n),"ajax"===n.type&&function(e){const t=e.el;if(!t)return;if(e.htmlEl||e.xhr)return;null==A||A.showLoading(e),e.state=0;const n=new XMLHttpRequest;n.onreadystatechange=function(){if(n.readyState===XMLHttpRequest.DONE&&V===_.Ready)if(null==A||A.hideLoading(e),e.state=1,200===n.status){let o=n.responseText+"",i=null,s=null;if(e.filter){const t=document.createElement("div");t.innerHTML=o,s=t.querySelector(e.filter+"")}s&&s instanceof HTMLElement?i=s:(i=document.createElement("div"),i.innerHTML=o),i.classList.add("f-html"),e.htmlEl=i,t.classList.add("has-html"),t.classList.add("has-ajax"),t.prepend(i),null==A||A.emit("contentReady",e)}else null==A||A.showError(e)};const o=Z("ajax")||null;n.open(o?"POST":"GET",e.src+""),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.send(o),e.xhr=n}(n)}function oe(e,t){var n;ye(t),null===(n=t.el)||void 0===n||n.removeEventListener("click",ie),"inline"!==t.type&&"clone"!==t.type||function(e){const t=e.htmlEl,n=e.placeholderEl;t&&("none"!==getComputedStyle(t).getPropertyValue("display")&&(t.style.display="none"),t.offsetHeight);n&&(t&&n.parentNode&&n.parentNode.insertBefore(t,n),n.remove());e.htmlEl=void 0,e.placeholderEl=void 0}(t),t.xhr&&(t.xhr.abort(),t.xhr=void 0)}function ie(e){if(!be())return;if(V!==_.Ready)return k(e),void e.stopPropagation();if(e.defaultPrevented)return;if(!m.isClickAllowed())return;const t=e.composedPath()[0];t.closest(".fancybox__carousel")&&t.classList.contains("fancybox__slide")&&fe(e)}function se(){G=!1,C&&A&&C.classList.remove("is-revealing"),de();const e=Z("sync");if(A&&e){const t=e.getPageIndex(A.getPageIndex())||0;e.goTo(t,{transition:!1,tween:!1})}}function le(){var e;!function(){const e=null==A?void 0:A.getViewport();if(!Z("dragToClose")||!A||!e)return;if(D=m(e).init(),!D)return;let t=!1,n=0,o=0,s={},l=1;function r(){var e,t;null==q||q.spring({clamp:!0,mass:1,tension:0===o?140:960,friction:17,restDelta:.1,restSpeed:.1,maxSpeed:1/0}).from({y:n}).to({y:o}).start();const i=(null===(e=null==A?void 0:A.getViewport())||void 0===e?void 0:e.getBoundingClientRect().height)||0,s=null===(t=Ee())||void 0===t?void 0:t.panzoomRef;if(i&&s)if(0===o)s.execute(v.Reset);else{const e=a(Math.abs(n),0,.33*i,l,.77*l,!1);s.execute(v.ZoomTo,{scale:e})}}const c=e=>{var t;const n=e.srcEvent,o=n.target;return A&&!(g(n)&&(null===(t=n.touches)||void 0===t?void 0:t.length)>1)&&o&&!i(o)};q=f().on("step",t=>{if(C&&e&&V===_.Ready){const o=e.getBoundingClientRect().height;n=Math.min(o,Math.max(-1*o,t.y));const i=a(Math.abs(n),0,.65*o,1,.2,!0);C.style.setProperty("--f-drag-opacity",i+""),C.style.setProperty("--f-drag-offset",n+"px")}}),D.on("start",function(){t||(null==q||q.pause(),o=n)}).on("panstart",e=>{var n,o;if(!t&&c(e)&&"y"===e.axis){k(e.srcEvent),t=!0,Ce(),null===(n=null==A?void 0:A.getViewport())||void 0===n||n.classList.add("is-dragging");const i=null===(o=Ee())||void 0===o?void 0:o.panzoomRef;if(i){l=i.getTransform().scale||1;const e=i.getOptions();s=Object.assign({},e),e.bounds=!1,e.gestures=!1}}else t=!1}).on("pan",function(e){t&&c(e)&&(k(e.srcEvent),e.srcEvent.stopPropagation(),"y"===e.axis&&(o+=e.deltaY,r()))}).on("end",e=>{var i,l,a;if(null===(i=null==A?void 0:A.getViewport())||void 0===i||i.classList.remove("is-dragging"),t){const t=null===(l=Ee())||void 0===l?void 0:l.panzoomRef;if(t){null===(a=t.getTween())||void 0===a||a.end();const e=t.getOptions();e.bounds=s.bounds||!1,e.gestures=s.gestures||!1}c(e)&&"y"===e.axis&&(Math.abs(e.velocityY)>5||Math.abs(n)>50)&&Me(e.srcEvent,"f-throwOut"+(e.velocityY>0?"Down":"Up"))}t=!1,V===_.Ready&&0!==n&&(o=0,r())})}(),document.body.addEventListener("click",pe),document.body.addEventListener("keydown",ge,{passive:!1,capture:!0}),de(),je();const t=Z("sync");A&&t&&(null===(e=t.getTween())||void 0===e||e.start()),he(Ee())}function re(){(null==A?void 0:A.canGoNext())?je():Te()}function ae(e,t){ve(t)}function ce(e,t){ve(t),he(t)}function ue(){var e;const t=null==A?void 0:A.getPlugins().Thumbs;d(C,"has-thumbs",(null==t?void 0:t.isEnabled())||!1),d(C,"has-vertical-thumbs",!!t&&("scrollable"===t.getType()||!0===(null===(e=t.getCarousel())||void 0===e?void 0:e.isVertical())))}function de(){if(C){const e=(null==A?void 0:A.getPages())||[],t=(null==A?void 0:A.getPageIndex())||0;for(const e of C.querySelectorAll("[data-fancybox-index]"))e.innerHTML=t+"";for(const e of C.querySelectorAll("[data-fancybox-page]"))e.innerHTML=t+1+"";for(const t of C.querySelectorAll("[data-fancybox-pages]"))t.innerHTML=e.length+""}}function fe(e){if(!!e.composedPath()[0].closest("[data-fancybox-close]"))return void Me(e);if(ee("backdropClick",e),e.defaultPrevented)return;Z("backdropClick")&&Me(e)}function me(){Pe()}function ge(e){if(!be())return;if(V!==_.Ready)return;const t=e.key,o=Z("keyboard");if(!o)return;if(e.ctrlKey||e.altKey||e.shiftKey)return;const i=e.composedPath()[0];if(!n(i))return;if("Escape"!==t&&(e=>{const t=["input","textarea","select","option","video","iframe","[contenteditable]","[data-selectable]","[data-draggable]"].join(",");return e.matches(t)||e.closest(t)})(i))return;if(ee("keydown",e),e.defaultPrevented)return;const s=o[t];if(s)switch(s){case"close":Me(e);break;case"next":k(e),null==A||A.next();break;case"prev":k(e),null==A||A.prev()}}function pe(e){if(!be())return;if(V!==_.Ready)return;if(Pe(),e.defaultPrevented)return;const t=e.composedPath()[0],n=!!t.closest("[data-fancybox-close]"),o=t.classList.contains("fancybox__backdrop");(n||o)&&fe(e)}function ve(e){var t;const{el:n,htmlEl:i,panzoomRef:s,closeButtonEl:l}=e,r=s?s.getWrapper():i;if(!n||!n.parentElement||!r)return;let a=Z("closeButton");if("auto"===a&&(a=!0!==(null===(t=null==A?void 0:A.getPlugins().Toolbar)||void 0===t?void 0:t.isEnabled())),a){if(!l){const t=o(J(Z("closeButtonTpl")));t&&(c(t,"is-close-button"),e.closeButtonEl=r.insertAdjacentElement("afterbegin",t),c(n,"has-close-btn"))}}else ye(e)}function ye(e){e.closeButtonEl&&(e.closeButtonEl.remove(),e.closeButtonEl=void 0),u(e.el,"has-close-btn")}function he(e){if(!(G&&A&&1===A.getState()&&e&&e.index===A.getOptions().initialPage&&e.el&&e.el.parentElement))return;if(void 0!==e.state&&1!==e.state)return;G=!1;const t=e.panzoomRef,n=null==t?void 0:t.getTween(),o=Z("zoomEffect")&&n?we(e):void 0;if(t&&n&&o){const{x:e,y:i,scale:s}=t.getStartPosition();return void n.spring({tension:215,friction:25,restDelta:.001,restSpeed:.001,maxSpeed:1/0}).from(o).to({x:e,y:i,scale:s}).start()}const i=(null==t?void 0:t.getContent())||e.htmlEl;i&&R(i,Z("showClass",e))}function be(){var e;return(null===(e=F.getInstance())||void 0===e?void 0:e.getId())===$}function Ee(){var e;return null===(e=null==A?void 0:A.getPage())||void 0===e?void 0:e.slides[0]}function xe(){const e=Ee();return e?e.triggerEl||Z("triggerEl"):void 0}function we(e){var t,n;const o=e.thumbEl;if(!o||!(e=>{const t=e.getBoundingClientRect(),n=e.closest("[style]"),o=null==n?void 0:n.parentElement;if(n&&n.style.transform&&o){const e=o.getBoundingClientRect();if(t.left<e.left||t.left>e.left+e.width-t.width)return!1;if(t.top<e.top||t.top>e.top+e.height-t.height)return!1}const i=Math.max(document.documentElement.clientHeight,window.innerHeight),s=Math.max(document.documentElement.clientWidth,window.innerWidth);return!(t.bottom<0||t.top-i>=0||t.right<0||t.left-s>=0)})(o))return;const i=null===(n=null===(t=e.panzoomRef)||void 0===t?void 0:t.getWrapper())||void 0===n?void 0:n.getBoundingClientRect(),s=null==i?void 0:i.width,l=null==i?void 0:i.height;if(!s||!l)return;const r=o.getBoundingClientRect();let a=r.width,c=r.height,u=r.left,d=r.top;if(!r||!a||!c)return;if(o instanceof HTMLImageElement){const e=window.getComputedStyle(o).getPropertyValue("object-fit");if("contain"===e||"scale-down"===e){const{width:t,height:n}=((e,t,n,o,i="contain")=>{if("contain"===i||e>n||t>o){const i=n/e,s=o/t,l=Math.min(i,s);e*=l,t*=l}return{width:e,height:t}})(o.naturalWidth,o.naturalHeight,a,c,e);u+=.5*(a-t),d+=.5*(c-n),a=t,c=n}}if(Math.abs(s/l-a/c)>.1)return;return{x:u+.5*a-(i.left+.5*s),y:d+.5*c-(i.top+.5*l),scale:a/s}}function Le(){N&&clearTimeout(N),N=void 0,document.removeEventListener("mousemove",me)}function je(){if(X)return;if(N)return;const e=Z("idle");e&&(N=setTimeout(Se,e))}function Se(){C&&(Le(),c(C,"is-idle"),document.addEventListener("mousemove",me),X=!0)}function Pe(){X&&(Te(),je())}function Te(){Le(),null==C||C.classList.remove("is-idle"),X=!1}function Ce(){const e=xe();var t;!e||(t=e.getBoundingClientRect()).bottom>0&&t.right>0&&t.left<(window.innerWidth||document.documentElement.clientWidth)&&t.top<(window.innerHeight||document.documentElement.clientHeight)||e.closest("[inert]")||e.scrollIntoView({behavior:"instant",block:"center",inline:"center"})}function Me(e,t){var n,o,i,s,r;if(V===_.Closing||V===_.Destroyed)return;const a=new Event("shouldClose",{bubbles:!0,cancelable:!0});if(ee("shouldClose",a,e),a.defaultPrevented)return;if(Le(),e){if(e.defaultPrevented)return;k(e),e.stopPropagation(),e.stopImmediatePropagation()}if(V=_.Closing,null==q||q.pause(),null==D||D.destroy(),A){null===(n=A.getGestures())||void 0===n||n.destroy(),null===(o=A.getTween())||void 0===o||o.pause();for(const e of A.getSlides()){const t=e.panzoomRef;t&&(l(t.getOptions(),{clickAction:!1,dblClickAction:!1,wheelAction:!1,bounds:!1,minScale:0,maxScale:1/0}),null===(i=t.getGestures())||void 0===i||i.destroy(),null===(s=t.getTween())||void 0===s||s.pause())}}const c=null==A?void 0:A.getPlugins();null===(r=null==c?void 0:c.Autoplay)||void 0===r||r.stop();const u=null==c?void 0:c.Fullscreen;u&&u.inFullscreen()?Promise.resolve(u.exit()).then(()=>{setTimeout(()=>{Ae(e,t)},150)}):Ae(e,t)}function Ae(e,t){var n,o;if(V!==_.Closing)return;ee("close",e),G=!1,document.body.removeEventListener("click",pe),document.body.removeEventListener("keydown",ge,{passive:!1,capture:!0}),Z("placeFocusBack")&&Ce();const i=document.activeElement;i&&(null==r?void 0:r.contains(i))&&i.blur(),Z("fadeEffect")&&(null==C||C.classList.remove("is-ready"),null==C||C.classList.add("is-hiding")),null==C||C.classList.add("is-closing");const s=Ee(),l=null==s?void 0:s.el,a=null==s?void 0:s.panzoomRef,c=null===(n=null==s?void 0:s.panzoomRef)||void 0===n?void 0:n.getTween(),u=t||Z("hideClass");let d=!1,m=!1;if(A&&s&&l&&a&&c){let e;if(Z("zoomEffect")&&1===s.state&&(e=we(s)),e){d=!0;const t=()=>{e=we(s),e?c.to(Object.assign(Object.assign({},p),e)):ke()};a.on("refresh",()=>{t()}),c.easing(f.Easings.EaseOut).duration(350).from(Object.assign({},a.getTransform())).to(Object.assign(Object.assign({},p),e)).start(),(null==l?void 0:l.getAnimations())&&(l.style.animationPlayState="paused",requestAnimationFrame(()=>{t()}))}}const g=(null==s?void 0:s.htmlEl)||(null===(o=null==s?void 0:s.panzoomRef)||void 0===o?void 0:o.getWrapper());g&&O(g),!d&&u&&g&&(m=!0,R(g,u,()=>{ke()})),d||m?setTimeout(()=>{ke()},350):ke()}function ke(){var e,t,n,o,i;if(V===_.Destroyed)return;V=_.Destroyed;const l=xe();ee("destroy"),null===(t=null===(e=Z("sync"))||void 0===e?void 0:e.getPlugins().Autoplay)||void 0===t||t.resume(),null===(o=null===(n=Z("sync"))||void 0===n?void 0:n.getPlugins().Autoscroll)||void 0===o||o.resume(),r instanceof HTMLDialogElement&&r.close(),null===(i=null==A?void 0:A.getContainer())||void 0===i||i.classList.remove("is-idle"),null==A||A.destroy();for(const e of Object.values(K))null==e||e.destroy();if(K={},null==r||r.remove(),r=void 0,C=void 0,A=void 0,z.delete($),!z.size&&(s(!1),document.documentElement.classList.remove(B),Z("placeFocusBack")&&l&&!l.closest("[inert]")))try{null==l||l.focus({preventScroll:!0})}catch(e){}}const Re={close:Me,destroy:ke,getCarousel:function(){return A},getContainer:function(){return C},getId:function(){return $},getOptions:function(){return W},getPlugins:function(){return K},getSlide:function(){return Ee()},getState:function(){return V},init:function(t=[],n={}){V!==_.Init&&(Re.destroy(),V=_.Init),W=l({},I,n),$=Z("id")||"fancybox-"+ ++H;const a=z.get($);if(a&&a.destroy(),z.set($,Re),ee("init"),function(){for(const[e,t]of Object.entries(Object.assign(Object.assign({},F.Plugins),W.plugins||{})))if(e&&!K[e]&&t instanceof Function){const n=t();n.init(Re),K[e]=n}ee("initPlugins")}(),function(e=[]){ee("initSlides",e),U=[...e]}(t),function(){const t=Z("parentEl")||document.body;if(!(t&&t instanceof HTMLElement))return;const n=J(Z("mainTpl")||"");if(r=o(n)||void 0,!r)return;if(C=r.querySelector(".fancybox__container"),!(C&&C instanceof HTMLElement))return;const l=Z("mainClass");l&&c(C,l);const a=Z("mainStyle");if(a&&e(a))for(const[e,t]of Object.entries(a))C.style.setProperty(e,t);const u=Z("theme"),d="auto"===u?window.matchMedia("(prefers-color-scheme:light)").matches:"light"===u;C.setAttribute("theme",d?"light":"dark"),r.setAttribute("id",`${$}`),r.addEventListener("keydown",e=>{"Escape"===e.key&&k(e)}),r.addEventListener("wheel",e=>{const t=e.target;let n=Z("wheel",e);t.closest(".f-thumbs")&&(n="slide");const o="slide"===n,s=[-e.deltaX||0,-e.deltaY||0,-e.detail||0].reduce(function(e,t){return Math.abs(t)>Math.abs(e)?t:e}),l=Math.max(-1,Math.min(1,s)),r=Date.now();Y&&r-Y<300?o&&k(e):(Y=r,ee("wheel",e,l),e.defaultPrevented||("close"===n?Me(e):"slide"===n&&A&&!i(t)&&(k(e),A[l>0?"prev":"next"]())))},{capture:!0,passive:!1}),r.addEventListener("cancel",e=>{Me(e)}),t.append(r),1===z.size&&(Z("hideScrollbar")&&s(!0),document.documentElement.classList.add(B));ee("initLayout"),r instanceof HTMLDialogElement&&(Z("modal")?r.showModal():r.show())}(),function(){if(M=(null==r?void 0:r.querySelector(".fancybox__carousel"))||void 0,!M)return;M.fancybox=Re;const e=l({},{Autoplay:{autoStart:!1,pauseOnHover:!1,progressbarParentEl:e=>{const t=e.getContainer();return(null==t?void 0:t.querySelector(".f-carousel__toolbar [data-autoplay-action]"))||t}},Fullscreen:{el:C},Toolbar:{absolute:!0,items:{counter:{tpl:'<div class="f-counter"><span data-fancybox-page></span>/<span data-fancybox-pages></span></div>'}},display:{left:["counter"],right:["toggleFull","autoplay","fullscreen","thumbs","close"]}},Video:{autoplay:!0},Thumbs:{minCount:2,Carousel:{classes:{container:"fancybox__thumbs"}}},classes:{container:"fancybox__carousel",viewport:"fancybox__viewport",slide:"fancybox__slide"},spinnerTpl:'<div class="f-spinner" data-fancybox-close></div>',dragFree:!1,slidesPerPage:1,plugins:{Sync:b,Arrows:x,Lazyload:E,Zoomable:h,Html:S,Video:P,Autoplay:L,Fullscreen:T,Thumbs:j,Toolbar:w}},Z("Carousel")||{},{slides:U,enabled:!0,initialPage:Z("startIndex")||0,l10n:Z("l10n")});A=y(M,e),ee("initCarousel",A),A.on("*",(e,t,...n)=>{ee(`Carousel.${t}`,e,...n)}),A.on("attachSlideEl",ne),A.on("detachSlideEl",oe),A.on("contentLoading",ae),A.on("contentReady",ce),A.on("ready",le),A.on("change",se),A.on("settle",re),A.on("thumbs:ready",ue),A.on("thumbs:destroy",ue),A.init()}(),r&&C){if(Z("closeExisting"))for(const[e,t]of z.entries())e!==$&&t.close();Z("fadeEffect")?(setTimeout(()=>{te()},500),c(C,"is-revealing")):te(),C.classList.add("is-ready"),V=_.Ready,ee("ready")}},isCurrentSlide:function(e){const t=Ee();return!(!e||!t)&&t.index===e.index},isTopMost:function(){return be()},localize:J,off:function(e,t){return Q.has(e)&&Q.set(e,Q.get(e).filter(e=>e!==t)),Re},on:function(e,t){return Q.set(e,[...Q.get(e)||[],t]),Re},toggleIdle(e){(X||!0===e)&&Se(),X&&!1!==e||Te()}};return Re};function q(){for(const e of Object.values(F.Plugins)){const t=e.setup;"function"==typeof t&&t(F)}}function N(e,t={}){var n,o,i;if(!(e&&e instanceof Element))return;let s,r,a,c,u={};for(const[t,n]of F.openers)if(t.contains(e))for(const[o,i]of n){let n;if(o){for(const i of t.querySelectorAll(o))if(i.contains(e)){n=i;break}if(!n)continue}for(const[o,d]of i){let i=null;try{i=e.closest(o)}catch(e){}i&&(r=t,a=n,s=i,c=o,l(u,d||{}))}}if(!r||!c||!s)return;const d=l({},I,t,u,{triggerEl:s});let f=[].slice.call((a||r).querySelectorAll(c));const m=s.closest(".f-carousel"),g=null==m?void 0:m.carousel;if(g&&(!a||!m.contains(a))){const e=[];for(const t of null==g?void 0:g.getSlides()){const n=t.el;n&&(n.matches(c)?e.push(n):e.push(...[].slice.call(n.querySelectorAll(c))))}e.length&&(f=[...e],null===(n=g.getPlugins().Autoplay)||void 0===n||n.pause(),null===(o=g.getPlugins().Autoscroll)||void 0===o||o.pause(),d.sync=g)}if(!1===d.groupAll){const e=d.groupAttr,t=e&&s?s.getAttribute(`${e}`):"";f=e&&t?f.filter(n=>n.getAttribute(`${e}`)===t):[s]}if(!f.length)return;null===(i=d.triggerEvent)||void 0===i||i.preventDefault();const p=F.getInstance(),v=null==p?void 0:p.getState();if(p&&(v===_.Init||v===_.Ready)){const e=p.getOptions().triggerEl;if(e&&f.indexOf(e)>-1)return}return Object.assign({},d.Carousel||{}).rtl&&(f=f.reverse()),s&&void 0===t.startIndex&&(d.startIndex=f.indexOf(s)),F.fromNodes(f,d)}const F={Plugins:{Hash:C},version:"6.1.11",openers:new Map,bind:function(e,n,o,i){if(!r())return;let s=document.body,l=null,a="[data-fancybox]",c={};e instanceof Element&&(s=e),t(e)&&t(n)?(l=e,a=n):t(n)&&t(o)?(l=n,a=o):t(n)?a=n:t(e)&&(a=e),"object"==typeof n&&(c=n||{}),"object"==typeof o&&(c=o||{}),"object"==typeof i&&(c=i||{}),function(e,t,n,o={}){if(!(e&&e instanceof Element&&n))return;const i=F.openers.get(e)||new Map,s=i.get(t)||new Map;s.set(n,o),i.set(t,s),F.openers.set(e,i),1===i.size&&e.addEventListener("click",F.fromEvent),q()}(s,l,a,c)},close:function(e=!0,...t){if(e)for(const e of z.values())e.close(...t);else{const e=F.getInstance();e&&e.close(...t)}},destroy:function(){let e;for(;e=F.getInstance();)e.destroy();for(const e of F.openers.keys())e.removeEventListener("click",F.fromEvent);F.openers.clear()},fromEvent:function(e){if(e.defaultPrevented)return;if(e.button&&0!==e.button)return;if(e.ctrlKey||e.metaKey||e.shiftKey)return;let t=e.composedPath()[0];const n={triggerEvent:e};if(t.closest(".fancybox__container.is-hiding"))return k(e),void e.stopPropagation();const o=t.closest("[data-fancybox-delegate]")||void 0;if(o){const e=o.dataset.fancyboxDelegate||"",i=document.querySelectorAll(`[data-fancybox="${e}"]`),s=parseInt(o.dataset.fancyboxIndex||"",10)||0;t=i[s]||i[0],l(n,{delegateEl:o,startIndex:s})}return N(t,n)},fromNodes:function(e,t){t=l({},I,t||{});const n=[],o=e=>e instanceof HTMLImageElement?e:e instanceof HTMLElement?e.querySelector("img:not([aria-hidden])"):void 0;for(const i of e){const s=i.dataset||{},l=t.delegateEl&&e.indexOf(i)===t.startIndex?t.delegateEl:void 0,r=o(l)||o(i)||void 0,a=s.src||i.getAttribute("href")||i.getAttribute("currentSrc")||i.getAttribute("src")||void 0,c=s.thumb||s.thumbSrc||(null==r?void 0:r.getAttribute("currentSrc"))||(null==r?void 0:r.getAttribute("src"))||(null==r?void 0:r.dataset.lazySrc)||void 0,u={src:a,alt:s.alt||(null==r?void 0:r.getAttribute("alt"))||void 0,thumbSrc:c,thumbEl:r,triggerEl:i,delegateEl:l};for(const e in s){let t=s[e]+"";t="false"!==t&&("true"===t||t),u[e]=t}n.push(u)}return F.show(n,t)},fromSelector:function(e,n,o,i){if(!r())return;let s=document.body,l=null,a="[data-fancybox]",c={};e instanceof Element&&(s=e),t(e)&&t(n)?(l=e,a=n):t(n)&&t(o)?(l=n,a=o):t(n)?a=n:t(e)&&(a=e),"object"==typeof n&&(c=n||{}),"object"==typeof o&&(c=o||{}),"object"==typeof i&&(c=i||{});for(const[e,t]of F.openers)for(const[n,o]of t)for(const[t,i]of o)if(e===s&&n===l){const e=s.querySelector((n?`${n} `:"")+a);if(e&&e.matches(t))return F.fromTriggerEl(e,c)}},fromTriggerEl:N,getCarousel:function(){var e;return(null===(e=F.getInstance())||void 0===e?void 0:e.getCarousel())||void 0},getDefaults:function(){return I},getInstance:function(e){if(e){const t=z.get(e);return t&&t.getState()!==_.Destroyed?t:void 0}return Array.from(z.values()).reverse().find(e=>{if(e.getState()!==_.Destroyed)return e})||void 0},getSlide:function(){var e;return(null===(e=F.getInstance())||void 0===e?void 0:e.getSlide())||void 0},show:function(e=[],t={}){return q(),D().init(e,t)},unbind:function(e,n,o){if(!r())return;let i=document.body,s=null,l="[data-fancybox]";e instanceof Element&&(i=e),t(e)&&t(n)?(s=e,l=n):t(n)&&t(o)?(s=n,l=o):t(n)?l=n:t(e)&&(l=e),function(e,t,n){if(!(e&&e instanceof Element&&n))return;const o=F.openers.get(e)||new Map,i=o.get(t)||new Map;i&&n&&i.delete(n),i.size&&n||o.delete(t),o.size||(F.openers.delete(e),e.removeEventListener("click",F.fromEvent))}(i,s,l)}};export{x as Arrows,L as Autoplay,y as Carousel,F as Fancybox,_ as FancyboxState,T as Fullscreen,S as Html,E as Lazyload,p as PANZOOM_DEFAULT_POS,v as PanzoomAction,b as Sync,j as Thumbs,w as Toolbar,P as Video,h as Zoomable};
