/*! License details at fancyapps.com/license */
import{isPlainObject as e}from"../utils/isPlainObject.js";import{isString as t}from"../utils/isString.js";import{isNode as n}from"../utils/isNode.js";import{stringToHtml as o}from"../utils/strToHtml.js";import{getScrollableParent as i}from"../utils/getScrollableParent.js";import{scrollLock as r}from"../utils/scrollLock.js";import{extend as s}from"../utils/extend.js";import{canUseDOM as l}from"../utils/canUseDOM.js";import{map as a}from"../utils/map.js";import{addClass as c}from"../utils/addClass.js";import{PANZOOM_DEFAULT_POS as u}from"../panzoom/panzoom.js";export{Panzoom,PanzoomAction,PanzoomZoomLevel}from"../panzoom/panzoom.js";import{Carousel as d}from"../carousel/carousel.js";import{Zoomable as f}from"../carousel/carousel.zoomable.js";import{Sync as m}from"../carousel/carousel.sync.js";import{Lazyload as p}from"../carousel/carousel.lazyload.js";import{Arrows as g}from"../carousel/carousel.arrows.js";import{Toolbar as v}from"../carousel/carousel.toolbar.js";export{ToolbarColumn}from"../carousel/carousel.toolbar.js";import{Autoplay as y}from"../carousel/carousel.autoplay.js";import{Thumbs as h}from"../carousel/carousel.thumbs.js";import{Html as b}from"../carousel/carousel.html.js";import{Video as E}from"../carousel/carousel.video.js";import{Fullscreen as x}from"../carousel/carousel.fullscreen.js";import{Hash as w}from"./fancybox.hash.js";import{Tween as L}from"../libs/tween.js";import{en_EN as j}from"./l10n/en_EN.js";import{Gestures as S}from"../libs/gestures.js";import{removeClass as P}from"../utils/removeClass.js";const C='<button class="f-button" title="{{CLOSE}}" data-fancybox-close><svg><path d="M19.286 4.714 4.714 19.286M4.714 4.714l14.572 14.572" /></svg></button>';v().add("close",{tpl:C});const T=e=>{e&&e.dispatchEvent(new CustomEvent("animationend",{bubbles:!1,cancelable:!0,currentTarget:e}))},A=(e=null,t="",n)=>{if(!e||!e.parentElement||!t)return void(n&&n());T(e);const o=i=>{i.target===e&&e.dataset.animationName&&(e.removeEventListener("animationend",o),delete e.dataset.animationName,n&&n(),e.classList.remove(t))};e.dataset.animationName=t,e.addEventListener("animationend",o),c(e,t)};var k;!function(e){e[e.Init=0]="Init",e[e.Ready=1]="Ready",e[e.Closing=2]="Closing",e[e.Destroyed=3]="Destroyed"}(k||(k={}));const M={ajax:null,backdropClick:"close",Carousel:{},closeButton:"auto",closeExisting:!1,delegateEl:void 0,dragToClose:!0,fadeEffect:!0,groupAll:!1,groupAttr:"data-fancybox",hideClass:"f-fadeOut",hideScrollbar:!0,id:void 0,idle:!1,keyboard:{Escape:"close",Delete:"close",Backspace:"close",PageUp:"next",PageDown:"prev",ArrowUp:"prev",ArrowDown:"next",ArrowRight:"next",ArrowLeft:"prev"},l10n:j,mainClass:"",mainStyle:{},mainTpl:'<dialog class="fancybox__dialog">\n    <div class="fancybox__container" tabindex="0" aria-label="{{MODAL}}">\n      <div class="fancybox__backdrop"></div>\n      <div class="fancybox__carousel"></div>\n    </div>\n  </dialog>',on:{},parentEl:void 0,placeFocusBack:!0,showClass:"f-zoomInUp",startIndex:0,sync:void 0,theme:"dark",triggerEl:void 0,triggerEvent:void 0,zoomEffect:!0},O=new Map;let _=0;const D="with-fancybox",R=()=>{let l,w,j,R,z,H=k.Init,B=Object.assign({},M),N=-1,q={},V=[],F=!1,W=!0,$=0;function K(e,...t){let n=B[e];return n&&"function"==typeof n?n(je,...t):n}function U(e,t=[]){const n=K("l10n")||{};e=String(e).replace(/\{\{(\w+)\}\}/g,((e,t)=>n[t]||e));for(let n=0;n<t.length;n++)e=e.split(t[n][0]).join(t[n][1]);return e=e.replace(/\{\{(.*?)\}\}/g,((e,t)=>t))}const G=new Map;function X(e,...t){const n=G.get(e)||[];for(const[t,o]of Object.entries(B.on||{}))(t===e||t.split(" ").indexOf(e)>-1)&&n.push(o);for(const e of n)e&&"function"==typeof e&&e(je,...t);"*"!==e&&X("*",e,...t)}function Y(t=[],n={}){H!==k.Init&&(je.destroy(),H=k.Init),B=s({},M,n),N=K("id")||"fancybox-"+ ++_;const a=O.get(N);if(a&&a.destroy(),O.set(N,je),X("init"),function(){for(const[e,t]of Object.entries(Object.assign(Object.assign({},I.Plugins),B.plugins||{})))if(e&&!q[e]&&t instanceof Function){const n=t();n.init(je),q[e]=n}X("initPlugins")}(),function(e=[]){X("initSlides",e),V=[...e]}(t),function(){const t=K("parentEl")||document.body;if(!(t&&t instanceof HTMLElement))return;const n=U(K("mainTpl")||"");if(l=o(n)||void 0,!(l&&l instanceof HTMLDialogElement))return;if(w=l.querySelector(".fancybox__container"),!(w&&w instanceof HTMLElement))return;const s=K("mainClass");s&&c(w,s);const a=K("mainStyle");if(a&&e(a))for(const[e,t]of Object.entries(a))w.style.setProperty(e,t);const u=K("theme"),d="auto"===u?window.matchMedia("(prefers-color-scheme:light)").matches:"light"===u;w.setAttribute("theme",d?"light":"dark"),l.setAttribute("id",`${N}`),l.addEventListener("keydown",(e=>{"Escape"===e.key&&e.preventDefault()})),l.addEventListener("wheel",(e=>{const t=e.target;let n=K("wheel",e);t.closest(".f-thumbs")&&(n="slide");const o="slide"===n,r=[-e.deltaX||0,-e.deltaY||0,-e.detail||0].reduce((function(e,t){return Math.abs(t)>Math.abs(e)?t:e})),s=Math.max(-1,Math.min(1,r)),l=Date.now();$&&l-$<300?o&&e.preventDefault():($=l,X("wheel",e,s),e.defaultPrevented||("close"===n?xe(e):"slide"===n&&R&&!i(t)&&(e.preventDefault(),R[s>0?"prev":"next"]())))}),{capture:!0,passive:!1}),l.addEventListener("cancel",(e=>{xe(e)})),t.append(l),1===O.size&&(K("hideScrollbar")&&r(!0),document.documentElement.classList.add(D));l.showModal(),X("initLayout")}(),function(){if(j=(null==l?void 0:l.querySelector(".fancybox__carousel"))||void 0,!j)return;const e=s({Autoplay:{autoStart:!1,pauseOnHover:!1,progressbarParentEl:e=>{const t=e.getContainer();return(null==t?void 0:t.querySelector(".f-carousel__toolbar [data-autoplay-action]"))||t}},Fullscreen:{el:w},Toolbar:{absolute:!0,display:{left:["counter"],right:["toggleFull","autoplay","fullscreen","thumbs","close"]}},Video:{autoplay:!0},Zoomable:{Panzoom:{event:K("triggerEvent")}},classes:{container:"fancybox__carousel",viewport:"fancybox__viewport",slide:"fancybox__slide"},spinnerTpl:'<div class="f-spinner" data-fancybox-close></div>',dragFree:!1,slidesPerPage:1,plugins:{Sync:m,Arrows:g,Lazyload:p,Zoomable:f,Html:b,Video:E,Autoplay:y,Fullscreen:x,Thumbs:h,Toolbar:v}},K("Carousel")||{},{slides:V,enabled:!0,initialPage:K("startIndex")||0,l10n:K("l10n")});R=d(j,e),X("initCarousel",R),R.on("*",((e,t,...n)=>{X(`Carousel.${t}`,e,...n)})),null==R||R.on("addSlide",te),R.on("attachSlideEl",ne),R.on("detachSlideEl",oe),R.on("contentReady",ce),R.on("ready",se),R.on("change",re),R.on("settle",le),R.init()}(),l&&w){if(K("closeExisting"))for(const[e,t]of O.entries())e!==N&&t.close();K("fadeEffect")?(setTimeout((()=>{Z()}),500),c(w,"is-revealing")):Z(),w.classList.add("is-ready"),H=k.Ready,X("ready")}}function Z(){P(w,"is-revealing");try{if(document.activeElement===l){((null==w?void 0:w.querySelector("[autofocus]"))||w).focus()}}catch(e){}}function J(e){if(!fe())return;if(H!==k.Ready)return e.preventDefault(),void e.stopPropagation();if(e.defaultPrevented)return;if(!S.isClickAllowed())return;const t=e.composedPath()[0];t.closest(".fancybox__carousel")&&t.classList.contains("fancybox__slide")&&Q(e)}function Q(e){if(!!e.composedPath()[0].closest("[data-fancybox-close]"))return void xe(e);if(X("backdropClick",e),e.defaultPrevented)return;K("backdropClick")&&xe(e)}function ee(e){if(!fe())return;if(H!==k.Ready)return;if(be(),e.defaultPrevented)return;const t=e.composedPath()[0],n=!!t.closest("[data-fancybox-close]"),o=t.classList.contains("fancybox__backdrop");(n||o)&&Q(e)}function te(e,t){var n;null===(n=t.el)||void 0===n||n.addEventListener("click",J)}function ne(e,n){ie(n),"inline"!==n.type&&"clone"!==n.type||function(e){if(!R||!e||!e.el)return;let n=null;if(t(e.src)){const t=e.src.split("#",2).pop();n=t?document.getElementById(t):null}if(n){if(c(n,"f-html"),"clone"===e.type||n.closest(".fancybox__carousel")){n=n.cloneNode(!0);const t=n.dataset.animationName;t&&(n.classList.remove(t),delete n.dataset.animationName);let o=n.getAttribute("id");o=o?`${o}--clone`:`clone-${N}-${e.index}`,n.setAttribute("id",o)}else if(n.parentNode){const t=document.createElement("div");t.inert=!0,n.parentNode.insertBefore(t,n),e.placeholderEl=t}e.htmlEl=n,c(e.el,"has-html"),e.el.prepend(n),n.classList.remove("hidden"),"none"===n.style.display&&(n.style.display=""),"none"===getComputedStyle(n).getPropertyValue("display")&&(n.style.display=n.dataset.display||"flex"),null==R||R.emit("contentReady",e)}else null==R||R.showError(e,"{{ELEMENT_NOT_FOUND}}")}(n),"ajax"===n.type&&function(e){const t=e.el;if(!t)return;if(e.htmlEl||e.xhr)return;null==R||R.showLoading(e),e.state=0;const n=new XMLHttpRequest;n.onreadystatechange=function(){if(n.readyState===XMLHttpRequest.DONE&&H===k.Ready)if(null==R||R.hideLoading(e),e.state=1,200===n.status){let o=n.responseText+"",i=null,r=null;if(e.filter){const t=document.createElement("div");t.innerHTML=o,r=t.querySelector(e.filter+"")}r&&r instanceof HTMLElement?i=r:(i=document.createElement("div"),i.innerHTML=o),i.classList.add("f-html"),e.htmlEl=i,t.classList.add("has-html"),t.classList.add("has-ajax"),t.prepend(i),null==R||R.emit("contentReady",e)}else null==R||R.showError(e)};const o=K("ajax")||null;n.open(o?"POST":"GET",e.src+""),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.send(o),e.xhr=n}(n)}function oe(e,t){!function(e){e.closeButtonEl&&(e.closeButtonEl.remove(),e.closeButtonEl=void 0)}(t),"inline"!==t.type&&"clone"!==t.type||function(e){const t=e.htmlEl,n=e.placeholderEl;t&&("none"!==getComputedStyle(t).getPropertyValue("display")&&(t.style.display="none"),t.offsetHeight);n&&(t&&n.parentNode&&n.parentNode.insertBefore(t,n),n.remove());e.htmlEl=void 0,e.placeholderEl=void 0}(t),t.xhr&&(t.xhr.abort(),t.xhr=void 0)}function ie(e){var t;const{el:n,htmlEl:i,closeButtonEl:r}=e;if(!n||!i||r)return;let s=K("closeButton");if("auto"===s&&(s=!0!==(null===(t=null==R?void 0:R.getPlugins().Toolbar)||void 0===t?void 0:t.isEnabled())),s){const t=o(U(C));t&&(e.closeButtonEl=i.insertAdjacentElement("afterbegin",t),n.classList.add("has-close-btn"))}}function re(){W=!1,w&&R&&w.classList.remove("is-revealing");const e=K("sync");if(R&&e){const t=e.getPageIndex(R.getPageIndex())||0;e.goTo(t,{transition:!1})}}function se(){var e;if(H!==k.Ready)return;ae(me()),function(){if(!K("dragToClose"))return;if(!R)return;if(!R.getViewport())return;const e=R.getGestures();if(!e)return;let t=0,n=0,o=L().on("step",(e=>{t=e.y;const n=null==R?void 0:R.getViewport();if(w&&n){const e=a(Math.abs(t),0,.5*n.getBoundingClientRect().height,1,.5);w.style.setProperty("--f-drag-opacity",e+""),w.style.setProperty("--f-drag-offset",t+"px")}})).on("end",(()=>{if(!t){w&&w.style.removeProperty("--f-opacity");const e=null==R?void 0:R.getViewport();e&&(e.style.transform="")}}));e.on("start",(function(){o.pause()})).on("panstart",(e=>{var t;const n=e.srcEvent.target;n&&!i(n)&&(null===(t=null==R?void 0:R.getViewport())||void 0===t||t.classList.add("is-dragging"))})).on("pan",(function(e){const r=e.srcEvent.target;r&&i(r)||(null==R?void 0:R.getViewport())&&"y"===e.axis&&(n+=e.deltaY,o.spring({clamp:!0,mass:1,tension:860,friction:17,restDelta:.01,restSpeed:.01}).from({y:t}).to({y:n}).start())})).on("end",(function(e){o.pause(),"y"===e.axis&&Math.abs(e.velocityY)>5&&Math.abs(n)>0?xe(e.srcEvent,"f-throwOut"+(e.velocityY>0?"Down":"Up")):0!==n&&(n=0,o.spring({clamp:!0,mass:1,tension:140,friction:25,restDelta:.1,restSpeed:.1,maxSpeed:1/0}).from({y:t}).to({y:n}).start())}))}(),document.body.addEventListener("click",ee),document.body.addEventListener("keydown",de,{passive:!1,capture:!0}),ye();const t=K("sync");t&&(null===(e=t.getTween())||void 0===e||e.start())}function le(){(null==R?void 0:R.canGoNext())?ye():Ee()}function ae(e){if(!(W&&R&&1===R.getState()&&e&&e.index===R.getOptions().initialPage&&e.el&&e.el.parentElement))return;if(void 0!==e.state&&1!==e.state)return;W=!1;const t=e.panzoomRef,n=null==t?void 0:t.getTween(),o=K("zoomEffect")?ge(e):void 0;if(t&&n&&o){const e=t.getScale("base")||1,{x:i,y:r}=t.getMousemovePos(e)||{x:0,y:0};return void n.spring({tension:225,friction:25,restDelta:.001,restSpeed:.001,maxSpeed:1/0}).from(o).to({x:i,y:r,scale:e}).start()}const i=(null==t?void 0:t.getWrapper())||e.htmlEl;i&&A(i,K("showClass",e))}function ce(e,t){ie(t),ae(t)}function ue(){be()}function de(e){if(!fe())return;if(H!==k.Ready)return;const t=e.key,o=K("keyboard");if(!o)return;if(e.ctrlKey||e.altKey||e.shiftKey)return;const i=e.composedPath()[0];if(!n(i))return;if("Escape"!==t&&(e=>{const t=["input","textarea","select","option","video","iframe","[contenteditable]","[data-selectable]","[data-draggable]"].join(",");return e.matches(t)||e.closest(t)})(i))return;if(X("keydown",e),e.defaultPrevented)return;const r=o[t];if(r)switch(r){case"close":xe(e);break;case"next":e.preventDefault(),null==R||R.next();break;case"prev":e.preventDefault(),null==R||R.prev()}}function fe(){var e;return(null===(e=I.getInstance())||void 0===e?void 0:e.getId())===N}function me(){var e;return null===(e=null==R?void 0:R.getPage())||void 0===e?void 0:e.slides[0]}function pe(){const e=me();return e?e.triggerEl||K("triggerEl"):void 0}function ge(e){var t,n;const o=null===(n=null===(t=e.panzoomRef)||void 0===t?void 0:t.getWrapper())||void 0===n?void 0:n.getBoundingClientRect(),i=null==o?void 0:o.width,r=null==o?void 0:o.height;if(!i||!r)return;const s=e.thumbEl;if(!s)return;const l=s.getBoundingClientRect();let a=l.width,c=l.height,u=l.left,d=l.top;if(!l||!a||!c)return;if(!(e=>{const t=e.getBoundingClientRect(),n=e.closest("[style]"),o=null==n?void 0:n.parentElement;if(n&&n.style.transform&&o){const e=o.getBoundingClientRect();if(t.left<e.left||t.left>e.left+e.width-t.width)return!1;if(t.top<e.top||t.top>e.top+e.height-t.height)return!1}const i=Math.max(document.documentElement.clientHeight,window.innerHeight),r=Math.max(document.documentElement.clientWidth,window.innerWidth);return!(t.bottom<0||t.top-i>=0||t.right<0||t.left-r>=0)})(s))return;if(s instanceof HTMLImageElement){const e=window.getComputedStyle(s).getPropertyValue("object-fit");if("contain"===e||"scale-down"===e){const{width:t,height:n}=((e,t,n,o,i="contain")=>{if("contain"===i||e>n||t>o){const i=n/e,r=o/t,s=Math.min(i,r);e*=s,t*=s}return{width:e,height:t}})(s.naturalWidth,s.naturalHeight,a,c,e);u+=.5*(a-t),d+=.5*(c-n),a=t,c=n}}if(Math.abs(i/r-a/c)>.1)return;return{x:u+.5*a-(o.left+.5*i),y:d+.5*c-(o.top+.5*r),scale:a/i}}function ve(){z&&clearTimeout(z),z=void 0,document.removeEventListener("mousemove",ue)}function ye(){if(F)return;if(z)return;const e=K("idle");e&&(z=setTimeout(he,e))}function he(){w&&(ve(),c(w,"is-idle"),document.addEventListener("mousemove",ue),F=!0)}function be(){F&&(Ee(),ye())}function Ee(){ve(),null==w||w.classList.remove("is-idle"),F=!1}function xe(e,t){var n,o,i,r,l,a;if(H===k.Closing||H===k.Destroyed)return;if(H=k.Closing,ve(),e){if(e.defaultPrevented)return;e.cancelable&&e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation()}if(R){null===(n=R.getGestures())||void 0===n||n.destroy(),null===(o=R.getTween())||void 0===o||o.pause();const e=me(),t=null==e?void 0:e.panzoomRef;e&&t&&s(t.getOptions(),{clickAction:!1,wheelAction:!1,bounds:!1,minScale:0,maxScale:1/0});for(const e of R.getSlides())null===(r=null===(i=e.panzoomRef)||void 0===i?void 0:i.getGestures())||void 0===r||r.destroy(),null===(a=null===(l=e.panzoomRef)||void 0===l?void 0:l.getTween())||void 0===a||a.pause()}const c=null==R?void 0:R.getPlugins().fullscreen;c&&c.inFullscreen()?Promise.resolve(c.exit()).then((()=>{setTimeout((()=>{we(e,t)}),150)})):we(e,t)}function we(e,t){var n,o,i,r,s;if(H!==k.Closing)return;if(X("close",e),K("placeFocusBack")){const e=pe();!e||(s=e.getBoundingClientRect()).bottom>0&&s.right>0&&s.left<(window.innerWidth||document.documentElement.clientWidth)&&s.top<(window.innerHeight||document.documentElement.clientHeight)||e.scrollIntoView({behavior:"instant",block:"center",inline:"center"})}K("fadeEffect")&&(null==w||w.classList.remove("is-ready"),null==w||w.classList.add("is-hiding")),null==w||w.classList.add("is-closing");const l=me(),a=null==l?void 0:l.panzoomRef,c=null===(n=null==l?void 0:l.panzoomRef)||void 0===n?void 0:n.getTween(),d=t||K("hideClass");let f=!1,m=!1;if(R&&l&&a&&c){let e;K("zoomEffect")&&((null===(i=null===(o=R.getTween())||void 0===o?void 0:o.getCurrentVelocities())||void 0===i?void 0:i.pos)||0)<700&&1===l.state&&(e=ge(l)),e&&(f=!0,R.on("refresh",(()=>{const e=ge(l);e&&c.to(Object.assign(Object.assign({},u),e))})),c.easing(L.Easings.EaseOut).duration(350).from(Object.assign({},a.getTransform())).to(Object.assign(Object.assign({},u),e)).start())}const p=(null==l?void 0:l.htmlEl)||(null===(r=null==l?void 0:l.panzoomRef)||void 0===r?void 0:r.getWrapper());p&&T(p),!f&&d&&p&&(m=!0,A(p,d,(()=>{Le()}))),f||m?setTimeout((()=>{Le()}),350):Le()}function Le(){var e,t,n,o,i;if(H===k.Destroyed)return;H=k.Destroyed,document.body.removeEventListener("click",ee),document.body.removeEventListener("keydown",de,{passive:!1,capture:!0});const s=pe();X("destroy"),null===(t=null===(e=K("sync"))||void 0===e?void 0:e.getPlugins().Autoplay)||void 0===t||t.resume(),null===(o=null===(n=K("sync"))||void 0===n?void 0:n.getPlugins().Autoscroll)||void 0===o||o.resume(),l instanceof HTMLDialogElement&&l.close(),null===(i=null==R?void 0:R.getContainer())||void 0===i||i.classList.remove("is-idle"),null==R||R.destroy();for(const e of Object.values(q))null==e||e.destroy();if(q={},null==l||l.remove(),l=void 0,w=void 0,R=void 0,O.delete(N),!O.size&&(r(!1),document.documentElement.classList.remove(D),K("placeFocusBack")))try{null==s||s.focus({preventScroll:!0})}catch(e){}}const je={close:xe,destroy:Le,getCarousel:function(){return R},getContainer:function(){return w},getId:function(){return N},getOptions:function(){return B},getPlugins:function(){return q},getSlide:function(){return me()},getState:function(){return H},init:function(e=[],t={}){return Y(e,t),je},isCurrentSlide:function(e){const t=me();return!(!e||!t)&&t.index===e.index},isTopMost:function(){return fe()},off:function(e,t){return G.has(e)&&G.set(e,G.get(e).filter((e=>e!==t))),je},on:function(e,t){return G.set(e,[...G.get(e)||[],t]),je},toggleIdle(e){(F||!0===e)&&he(),F&&!1!==e||Ee()}};return je};const I={Plugins:{Hash:w},version:"6.0.17",openers:new Map,bind:function(e,n,o){if(!l())return;let i=document.body,r="[data-fancybox]",s={};if(t(e)?(i=document.body,r=e,"object"==typeof n&&(s=n||{})):e instanceof Element&&(i=e,t(n)&&(r=n),"object"==typeof o&&(s=o||{})),!(i&&i instanceof Element&&r))return!1;const a=I.openers.get(i)||new Map;if(a.set(r,s),I.openers.set(i,a),1===a.size){i.addEventListener("click",I.fromEvent);for(const e of Object.values(I.Plugins)){const t=e.setup;"function"==typeof t&&t(I)}}return!0},close:function(e=!0,...t){if(e)for(const e of O.values())e.close(...t);else{const e=I.getInstance();e&&e.close(...t)}},destroy:function(){let e;for(;e=I.getInstance();)e.destroy();for(const e of I.openers.keys())e.removeEventListener("click",I.fromEvent);I.openers.clear()},fromEvent:function(e){var t,n,o;if(e.defaultPrevented)return;if(e.button&&0!==e.button)return;if(e.ctrlKey||e.metaKey||e.shiftKey)return;let i=e.composedPath()[0];if(i.closest(".fancybox__container.is-hiding"))return e.preventDefault(),void e.stopPropagation();const r=i.closest("[data-fancybox-delegate]")||void 0;if(r){const e=r.dataset.fancyboxDelegate||"",t=document.querySelectorAll(`[data-fancybox="${e}"]`);i=t[parseInt(r.dataset.fancyboxIndex||"",10)||0]||t[0]}if(!(i&&i instanceof Element))return;let l,a,c;for(const e of Array.from(I.openers.keys()).reverse()){const t=I.openers.get(e);if(t&&e.contains(i))for(const n of Array.from(t.keys()).reverse()){let o=null;try{o=i.closest(n)}catch(e){}if(o){i=o,l=e,a=n,c=t.get(n);break}}}if(!(l&&a&&c))return;e.preventDefault();const u=s({},M,{triggerEvent:e,triggerEl:i,delegateEl:r},c),d=u.groupAll,f=u.groupAttr,m=f&&i?i.getAttribute(`${f}`):"";let p=[];const g=null===(t=i.closest(".f-carousel"))||void 0===t?void 0:t.carousel;if(g){const e=[];for(const t of null==g?void 0:g.getSlides()){const n=t.el;n&&(n.matches(a)?e.push(n):e.push(...[].slice.call(n.querySelectorAll(a))))}e.length&&(p=[...e],null===(n=g.getPlugins().Autoplay)||void 0===n||n.pause(),null===(o=g.getPlugins().Autoscroll)||void 0===o||o.pause(),u.sync=g)}else(!i||m||d)&&(p=[].slice.call(l.querySelectorAll(a)));if(i&&!d&&(p=m?p.filter((e=>e.getAttribute(`${f}`)===m)):[i]),!p.length)return;const v=I.getInstance();if(v){const e=v.getOptions().triggerEl;if(e&&p.indexOf(e)>-1)return}return Object.assign({},u.Carousel||{}).rtl&&(p=p.reverse()),i&&(u.startIndex=p.indexOf(i)),I.fromNodes(p,u)},fromNodes:function(e,t){t=s({},M,t||{});const n=[],o=e=>e instanceof HTMLImageElement?e:e instanceof HTMLElement?e.querySelector("img:not([aria-hidden])"):void 0;for(const i of e){const r=i.dataset||{},s=t.delegateEl&&e.indexOf(i)===t.startIndex?t.delegateEl:void 0,l=o(s)||o(i)||void 0,a=r.src||i.getAttribute("href")||i.getAttribute("currentSrc")||i.getAttribute("src")||void 0,c=r.thumb||r.thumbSrc||(null==l?void 0:l.getAttribute("currentSrc"))||(null==l?void 0:l.getAttribute("src"))||(null==l?void 0:l.dataset.lazySrc)||void 0,u={src:a,alt:r.alt||(null==l?void 0:l.getAttribute("alt"))||void 0,thumbSrc:c,thumbEl:l,triggerEl:i,delegateEl:s};for(const e in r){let t=r[e]+"";t="false"!==t&&("true"===t||t),u[e]=t}n.push(u)}return I.show(n,t)},fromSelector:function(e,n,o){let i=document.body,r="",l={};if(t(e)?r=e:e instanceof Element&&(i=e,t(n)&&(r=n),"object"==typeof o&&(l=o||{})),!(i&&i instanceof Element&&r))return;const a=I.openers.get(i);return a?(l=s({},a.get(r)||{},l),l?I.fromNodes(Array.from(i.querySelectorAll(r)),l):void 0):void 0},getCarousel:function(){var e;return(null===(e=I.getInstance())||void 0===e?void 0:e.getCarousel())||void 0},getDefaults:function(){return M},getInstance:function(e){if(e){const t=O.get(e);return t&&t.getState()!==k.Destroyed?t:void 0}return Array.from(O.values()).reverse().find((e=>{if(e.getState()!==k.Destroyed)return e}))||void 0},getSlide:function(){var e;return(null===(e=I.getInstance())||void 0===e?void 0:e.getSlide())||void 0},show:function(e=[],t={}){return R().init(e,t)},unbind:function(e,n){let o=document.body,i="";if(t(e)?i=e:e instanceof Element&&(o=e,t(n)&&(i=n)),o){const e=I.openers.get(o);e&&i&&e.delete(i),(null==e?void 0:e.size)&&i||I.openers.delete(o),o.removeEventListener("click",I.fromEvent)}}};export{g as Arrows,y as Autoplay,d as Carousel,I as Fancybox,k as FancyboxState,x as Fullscreen,b as Html,p as Lazyload,u as PANZOOM_DEFAULT_POS,m as Sync,h as Thumbs,v as Toolbar,E as Video,f as Zoomable};
