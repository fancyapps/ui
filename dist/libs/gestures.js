/*! License details at fancyapps.com/license */
function e(e){return"undefined"!=typeof TouchEvent&&e instanceof TouchEvent}function t(t,n){const o=[],s=e(t)?t[n]:t instanceof MouseEvent&&("changedTouches"===n||"mouseup"!==t.type)?[t]:[];for(const e of s)o.push({x:e.clientX,y:e.clientY,ts:Date.now()});return o}function n(e){return t(e,"touches")}function o(e){return t(e,"targetTouches")}function s(e){return t(e,"changedTouches")}function i(e){const t=e[0],n=e[1]||t;return{x:(t.x+n.x)/2,y:(t.y+n.y)/2,ts:n.ts}}function c(e){const t=e[0],n=e[1]||e[0];return t&&n?-1*Math.sqrt((n.x-t.x)*(n.x-t.x)+(n.y-t.y)*(n.y-t.y)):0}const r=e=>{e.cancelable&&e.preventDefault()},a={passive:!1},u={panThreshold:5,swipeThreshold:3,ignore:["textarea","input","select","[contenteditable]","[data-selectable]","[data-draggable]"]};let l=!1,d=!0;const f=(e,t)=>{let f,h,v,p=Object.assign(Object.assign({},u),t),g=[],m=[],E=[],w=!1,y=!1,T=!1,b=!1,M=0,x=0,L=0,P=0,D=0,X=0,Y=0,j=0,k=0,R=[],z=0,A=0;const O=new Map;function S(e){const t=c(m),n=c(E),o=t&&n?t/n:0,s=Math.abs(Y)>Math.abs(j)?Y:j,i={srcEvent:f,isPanRecognized:w,isSwipeRecognized:y,firstTouch:g,previousTouch:E,currentTouch:m,deltaX:L,deltaY:P,offsetX:D,offsetY:X,velocityX:Y,velocityY:j,velocity:s,angle:k,axis:v,scale:o,center:h};for(const t of O.get(e)||[])t(i)}function q(e){const t=Date.now();if(R=R.filter((e=>!e.ts||e.ts>t-100)),e&&R.push(e),Y=0,j=0,R.length>3){const e=R[0],t=R[R.length-1];if(e&&t){const n=t.x-e.x,o=t.y-e.y,s=e.ts&&t.ts?t.ts-e.ts:0;s>0&&(Y=Math.abs(n)>3?n/(s/30):0,j=Math.abs(o)>3?o/(s/30):0)}}}function C(e){if("undefined"!=typeof MouseEvent&&e instanceof MouseEvent){if(l)return}else l=!0;const t=e.composedPath()[0],n=p.ignore.join(",");if(t.matches(n)||t.closest(n))return;if("undefined"!=typeof MouseEvent&&e instanceof MouseEvent){if(!e.buttons||0!==e.button)return;r(e)}e instanceof MouseEvent&&(window.addEventListener("mousemove",I),window.addEventListener("mouseup",B)),window.addEventListener("blur",F),f=e,m=o(e),g=[...m],E=[],x=m.length,h=i(m),1===x&&(w=!1,y=!1,T=!1),x&&q(i(m));const s=Date.now(),c=s-(M||s);b=c>0&&c<=250&&1===x,M=s,clearTimeout(z),S("start")}function I(e){var t;if(!g.length)return;if(e.defaultPrevented)return;f=e,E=[...m],m=n(e);const o=i(E),s=i(n(e));if(q(s),x=m.length,h=s,E.length===m.length?(L=s.x-o.x,P=s.y-o.y):(L=0,P=0),g.length){const e=i(g);D=s.x-e.x,X=s.y-e.y}if(m.length>1){const e=c(m),t=c(E);Math.abs(e-t)>=.1&&(T=!0,S("pinch"))}w||(w=Math.abs(D)>p.panThreshold||Math.abs(X)>p.panThreshold,w&&(d=!1,clearTimeout(A),A=0,k=Math.abs(180*Math.atan2(X,D)/Math.PI),v=k>45&&k<135?"y":"x",g=[...m],E=[...m],D=0,X=0,L=0,P=0,null===(t=window.getSelection())||void 0===t||t.removeAllRanges(),S("panstart"))),w&&(L||P)&&S("pan"),S("move")}function B(e){if(f=e,!g.length)return;const t=o(e),n=s(e);if(x=t.length,h=i(n),n.length&&q(i(n)),E=[...m],m=[...t],g=[...t],x>0)S("end"),w=!1,y=!1,R=[];else{const e=p.swipeThreshold;(Math.abs(Y)>e||Math.abs(j)>e)&&(y=!0),w&&S("panend"),y&&S("swipe"),w||y||T||(S("tap"),b?S("doubleTap"):z=setTimeout((function(){S("singleTap")}),250)),S("end"),G()}}function F(){clearTimeout(z),G(),w&&S("panend"),S("end")}function G(){l=!1,w=!1,y=!1,b=!1,x=0,R=[],m=[],E=[],g=[],L=0,P=0,D=0,X=0,Y=0,j=0,k=0,v=void 0,window.removeEventListener("mousemove",I),window.removeEventListener("mouseup",B),window.removeEventListener("blur",F),d||A||(A=setTimeout((()=>{d=!0,A=0}),100))}function H(e){const t=e.target;l=!1,t&&!e.defaultPrevented&&(d||(r(e),e.stopPropagation()))}const J={init:function(){if(e)return e.addEventListener("click",H,a),e.addEventListener("mousedown",C,a),e.addEventListener("touchstart",C,a),e.addEventListener("touchmove",I,a),e.addEventListener("touchend",B),e.addEventListener("touchcancel",B),J},on:function(e,t){return function(e,t){O.set(e,[...O.get(e)||[],t])}(e,t),J},off:function(e,t){return O.has(e)&&O.set(e,O.get(e).filter((e=>e!==t))),J},isPointerDown:()=>x>0,destroy:function(){clearTimeout(z),clearTimeout(A),A=0,e&&(e.removeEventListener("click",H,a),e.removeEventListener("mousedown",C,a),e.removeEventListener("touchstart",C,a),e.removeEventListener("touchmove",I,a),e.removeEventListener("touchend",B),e.removeEventListener("touchcancel",B)),e=null,G()}};return J};f.isClickAllowed=()=>d;export{f as Gestures,s as getChangedPosition,n as getCurrentPosition,c as getDistance,i as getMidpoint,o as getTargetPosition,e as isTouchEvent};
